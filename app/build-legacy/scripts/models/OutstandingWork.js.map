{"version":3,"sources":["../../../scripts/models/OutstandingWork.js"],"names":[],"mappings":"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","file":"OutstandingWork.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.OutstandingWork\n *\n * @description This class wraps an outstanding work payload into an object\n *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar OutstandingWork = function () {};\n\nOutstandingWork.prototype = {\n\t/**\n\t * @ngdoc method\n\t * @name Models.OutstandingWork#fetch\n\t * @methodOf Models.OutstandingWork\n\t * @description Make a call to fetch raw data\n\t *\n\t * @param {String} link The URL to use for fetching the data\n\t * @param {Boolean} recalculate If true the call won't use ifModifiedSince option; otherwise a conditional get will be sent\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tfetch: function (link, recalculate) {\n\t\tvar that = this;\n\t\tvar options = {\n\t\t\tskipCache: true,\n\t\t\tifModifiedSince: !recalculate\n\t\t};\n\t\treturn this.RESTWrapperService.get(link, null, null, options).then(function (payload) {\n\t\t\tthat.json = payload;\n\t\t\tvar deferred = that.$q.defer();\n\t\t\tvar promises = [];\n\n\t\t\t// The main request\n\t\t\tangular.forEach(payload.outstandingWork, function (item, key) {\n\t\t\t\tvar localPromise = null;\n\t\t\t\tvar inboxItem = item.inboxItem;\n\t\t\t\tvar milestonesEndpoint;\n\t\t\t\tif (inboxItem && inboxItem.item && inboxItem.item.link) {\n\t\t\t\t\tlocalPromise = that.$q.defer();\n\t\t\t\t\tinboxItem.workspace.id = inboxItem.workspace.link.substring(inboxItem.workspace.link.lastIndexOf('/') + 1);\n\t\t\t\t\tinboxItem.workspace.label = inboxItem.workspace.title;\n\n\t\t\t\t\t// The item request\n\t\t\t\t\tthat.RESTWrapperService.get(inboxItem.item.link.substring(1), null, null, {skipCache: true, hideError: true})\n\t\t\t\t\t\t.then(function (masterPayload) {\n\t\t\t\t\t\t\tinboxItem.workflowStateName = masterPayload.currentState.title;\n\t\t\t\t\t\t\t// A required request to retrieve the milestones for each item\n\t\t\t\t\t\t\tif (masterPayload.milestones && masterPayload.milestones.link) {\n\t\t\t\t\t\t\t\tmilestonesEndpoint = masterPayload.milestones.link;\n\n\t\t\t\t\t\t\t\t// The milestones request\n\t\t\t\t\t\t\t\tthat.RESTWrapperService.get(milestonesEndpoint.substring(1), null, null, {hideError: true})\n\t\t\t\t\t\t\t\t\t.then(function (milestonesPayload) {\n\t\t\t\t\t\t\t\t\t\tif (milestonesPayload && milestonesPayload.milestones) {\n\t\t\t\t\t\t\t\t\t\t\tinboxItem.milestoneList = milestonesPayload.milestones;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlocalPromise.resolve();\n\t\t\t\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\t\t\t\tlocalPromise.resolve();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlocalPromise.resolve();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\tlocalPromise.resolve();\n\t\t\t\t\t\t});\n\t\t\t\t\tpromises.push(localPromise.promise);\n\t\t\t\t}\n\t\t\t});\n\t\t\tthat.$q.all(promises).then(function () {\n\t\t\t\tdeferred.resolve(that);\n\t\t\t});\n\t\t\treturn deferred.promise;\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.OutstandingWork#getDisplayableData\n\t * @methodOf Models.OutstandingWork\n\t * @description Returns formatted data of the outstanding work to be displayed in a tabular widget\n\t *\n\t * @param {Object} $filter The angularJS filter object to provide access to filters\n\t * @param {Function} parseDueDate The function to format the date string to be displayed\n\t * @param {String} dateFormat The format of date the user has set\n\t * @param {Object} FlyoutService The object to provide access to flyout service (for user profile summary)\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tgetDisplayableData: function ($filter, parseDueDate, dateFormat, FlyoutService) {\n\t\tvar ret = {};\n\t\tvar that = this;\n\n\t\tif ((angular.isDefined(this.json)) && (this.json !== null)) {\n\t\t\tret = angular.copy(this.json.outstandingWork);\n\n\t\t\tvar toBeSpliced = [];\n\t\t\tangular.forEach(ret, function (value, key) {\n\t\t\t\tret[key] = value.inboxItem;\n\t\t\t\tvar inboxItem = value.inboxItem;\n\t\t\t\tvar lastHistoryStep = value.lastHistoryStep;\n\n\t\t\t\tif (!ret[key].urn) {\n\t\t\t\t\ttoBeSpliced.push(key);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tret[key].escalations = ret[key].escalated ? '<span class=\"md icon-plm-task_finished\"></span>' : '';\n\t\t\t\tret[key].delegations = ret[key].delegated ? '<span class=\"md icon-plm-users\"></span>' : '';\n\n\t\t\t\tvar wsId = (inboxItem.item && inboxItem.item.link && inboxItem.item.link.split('/')[4]) || null;\n\t\t\t\tvar itemUrn = (inboxItem.item && inboxItem.item.urn && that.UrnParser.encode(inboxItem.item.urn)) || null;\n\t\t\t\tvar wsTitle = inboxItem.workspace && inboxItem.workspace.label;\n\n\t\t\t\tret[key].itemdescription = {\n\t\t\t\t\tval: inboxItem.item.title,\n\t\t\t\t\thref: that.$state.href('details', {\n\t\t\t\t\t\tworkspaceId: wsId,\n\t\t\t\t\t\ttab: 'details',\n\t\t\t\t\t\tview: 'full',\n\t\t\t\t\t\tmode: 'view',\n\t\t\t\t\t\titemId: itemUrn\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t\tret[key].workspace = {\n\t\t\t\t\tval: wsTitle,\n\t\t\t\t\thref: that.$state.href('workspace-items-list', {workspaceId: wsId})\n\t\t\t\t};\n\n\t\t\t\tret[key].workflowStateName = inboxItem.workflowStateName;\n\n\t\t\t\tif (lastHistoryStep) {\n\n\t\t\t\t\tret[key].statesetdate = {\n\t\t\t\t\t\tval: lastHistoryStep.created || '',\n\t\t\t\t\t\tdateFormat: dateFormat\n\t\t\t\t\t};\n\t\t\t\t\tret[key].user = lastHistoryStep.user || '';\n\t\t\t\t\tret[key].user.userId = ret[key].user.link &&\n\t\t\t\t\t\tret[key].user.link.substring(ret[key].user.link.lastIndexOf('/') + 1) || '';\n\n\t\t\t\t\tif (ret[key].milestoneList !== undefined) {\n\n\t\t\t\t\t\tret[key].milestone = parseDueDate(ret[key].milestoneList);\n\n\t\t\t\t\t\t// stateDate will be null if work item is completed.\n\t\t\t\t\t\tif (ret[key].milestone.stateDate) {\n\t\t\t\t\t\t\tret[key].duedate = {\n\t\t\t\t\t\t\t\tval: ret[key].milestone.stateDate,\n\t\t\t\t\t\t\t\tdateFormat: dateFormat\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tvar milestonecolor = ret[key].milestone.stateColor;\n\n\t\t\t\t\t\t\tvar toolTip = '';\n\n\t\t\t\t\t\t\tswitch (milestonecolor) {\n\t\t\t\t\t\t\t\tcase 'red':\n\t\t\t\t\t\t\t\t\ttoolTip = that.$rootScope.bundle.text.milestoneLate;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'orange':\n\t\t\t\t\t\t\t\t\ttoolTip = that.$rootScope.bundle.text.milestoneCloseToLate;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'green':\n\t\t\t\t\t\t\t\t\ttoolTip = that.$rootScope.bundle.text.milestoneOnTime;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tret[key].iconflag = '<span class=\"md md-flag ' + milestonecolor + '\" title=\"' + toolTip + '\"></span>';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tret[key].duedate = {\n\t\t\t\t\t\t\t\tval: ''\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tret[key].iconflag = '';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tret[key].duedate = '';\n\t\t\t\t\t\tret[key].iconflag = '';\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\tvar decrementCounter = 0;\n\t\t\tangular.forEach(toBeSpliced, function (value) {\n\t\t\t\tret.splice(value - decrementCounter, 1);\n\t\t\t\tdecrementCounter++;\n\t\t\t});\n\t\t}\n\n\t\treturn {data: ret};\n\t}\n};\n\nangular.module('plm360.models').factory('OutstandingWork', [\n\t'RESTWrapperService',\n\t'$rootScope',\n\t'$state',\n\t'$q',\n\t'EventService',\n\t'UrnParser',\n\tfunction (RESTWrapperService, $rootScope, $state, $q, EventService, UrnParser) {\n\t\tvar models = {};\n\t\tOutstandingWork.prototype.RESTWrapperService = RESTWrapperService;\n\t\tOutstandingWork.prototype.$rootScope = $rootScope;\n\t\tOutstandingWork.prototype.$state = $state;\n\t\tOutstandingWork.prototype.$q = $q;\n\t\tOutstandingWork.prototype.UrnParser = UrnParser;\n\n\t\tEventService.listen('outstandingWork:*:get', function (event, url, recalculate) {\n\t\t\tvar model = models[url] || new OutstandingWork();\n\t\t\tmodels[url] = model;\n\t\t\tmodel.fetch(url, recalculate).then(function (obj) {\n\t\t\t\tEventService.send('outstandingWork:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\n\t\treturn OutstandingWork;\n\t}\n]);\n"]}