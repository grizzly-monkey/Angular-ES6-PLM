{"version":3,"sources":["../../../scripts/models/AffectedItem.js"],"names":[],"mappings":"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","file":"AffectedItem.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.AffectedItem\n *\n * @description This class wraps a list of AffectedItems payload into an object\n *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar AffectedItem = function (json) {\n\tthis.json = json;\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getItemTitle\n\t * @methodOf Models.AffectedItem\n\t * @description Returns item title\n\t *\n\t * @returns {String} Item title\n\t */\n\tthis.getItemTitle = function () {\n\t\treturn this.json.item.title;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getWorkspaceId\n\t * @methodOf Models.AffectedItem\n\t * @description Returns workspace id\n\t *\n\t * @returns {String} Workspace id\n\t *\n\t * TODO: this is a hack. The server should return workspace information.\n\t */\n\tthis.getWorkspaceId = function () {\n\t\tvar urnTokens = this.json.item.urn.split('.');\n\t\treturn urnTokens[urnTokens.length - 2];\n\t};\n};\n\nAffectedItem.prototype = {\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#fetch\n\t * @methodOf Models.AffectedItem\n\t * @description Make a call to fetch raw data\n\t *\n\t * @param {String} link The URL to use for fetching the data\n\t * @param {String} eTag A unique string that can be used to determine whether the object to be fetch is modified\n\t * or not. Note: This is an optional parameter. If eTag is not provided that this function will behave like a simple\n\t * fetch function.\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tfetch: function (link, eTag) {\n\t\tvar that = this;\n\n\t\t// TODO: This header should be part of the core, so that it is applied for all supported requests.\n\t\tvar header = {};\n\t\tif (eTag) {\n\t\t\theader['If-None-Match'] = eTag;\n\t\t}\n\n\t\t// TODO: enable 'setFullResponse' to allow access of header information.\n\t\treturn this.RESTWrapperService.get(link, null, null, {skipCache: true}, header).then(function (payload) {\n\t\t\tif (payload.originalElement) {\n\t\t\t\tthat.json = payload;\n\t\t\t\treturn that;\n\t\t\t} else {\n\t\t\t\t// Since, we don't have access to response header, we have to convey (somehow) that the object is not\n\t\t\t\t// modified\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getItemUrn\n\t * @methodOf Models.AffectedItem\n\t * @description Returns item's urn\n\t *\n\t * @returns {String} The urn\n\t */\n\tgetItemUrn: function () {\n\t\treturn this.json.item.urn;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getObject\n\t * @methodOf Models.AffectedItem\n\t * @description Returns a copy of the object's JSON\n\t *\n\t * @returns {Object} The item object\n\t */\n\tgetObject: function () {\n\t\treturn angular.copy(this.json);\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getSelfLink\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the api link for this item\n\t *\n\t * @returns {Object} Link to object's api endpoint\n\t */\n\tgetSelfLink: function () {\n\t\treturn this.json.__self__.replace(/^\\//, '');\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getId\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the ID for this item\n\t *\n\t * @returns {Object} Item's ID\n\t */\n\tgetId: function () {\n\t\treturn +this.getSelfLink().match(/\\/(\\d+)$/)[1];\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getETag\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the ETag for this item\n\t *\n\t * @returns {Object} Item's ETag\n\t */\n\tgetETag: function () {\n\t\treturn this.json.restangularEtag;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#setTo\n\t * @methodOf Models.AffectedItem\n\t * @description Updates the to column of an item\n\t *\n\t * @param {String} toRelease The to release value\n\t */\n\tsetTo: function (toRelease) {\n\t\tthis.json.toRelease = toRelease;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#setLifecycle\n\t * @methodOf Models.AffectedItem\n\t * @description Updates the lifecycle state of an item\n\t *\n\t * @param {Object} transition The transition object\n\t * (contains a name and transition link)\n\t */\n\tsetLifecycle: function (transition) {\n\t\t// `null` implies 'On Release'\n\t\tif (!transition || transition.title === 'Please Select') {\n\t\t\tthis.json.targetTransition = null;\n\t\t} else {\n\t\t\tthis.json.targetTransition = {\n\t\t\t\tlink: transition.link || transition.__self__, // Required for endpoint\n\t\t\t\ttitle: transition.title || transition.name // Required to update view\n\t\t\t};\n\t\t}\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getLifecycle\n\t * @methodOf Models.AffectedItem\n\t * @description Returns a target transition of an item\n\t *\n\t * @return {Object} A target transition of this item\n\t */\n\tgetLifecycle: function () {\n\t\treturn this.json.targetTransition;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#setEffectivity\n\t * @methodOf Models.AffectedItem\n\t * @description Updates the effectivity date of an item\n\t *\n\t * @param {Date} effectivityDate The new effectivity date\n\t * (`null` implies 'On Release')\n\t */\n\tsetEffectivity: function (effectivityDate) {\n\t\tthis.json.effectivityDate = effectivityDate ?\n\t\t\tthis.$filter('date')(effectivityDate, 'yyyy-MM-dd') : null;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getEffectivity\n\t * @methodOf Models.AffectedItem\n\t * @description Returns an effectivity date of the revision of this item\n\t *\n\t * @return {String} An effectivity date of the revision of this item\n\t */\n\tgetEffectivity: function () {\n\t\treturn this.json.effectivityDate;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#setCustomColumnData\n\t * @methodOf Models.AffectedItem\n\t * @description Updates a linked field of a custom column\n\t *\n\t * @param {String} fieldID ID of a custom column\n\t * @param {Object} data The modified linked field object\n\t * @param {Object} col The custom column\n\t */\n\tsetCustomColumnData: function (fieldId, data, col) {\n\t\tlet linkedFields = this.json.linkedFields;\n\n\t\tlet linkedFieldToUpdate = _.find(linkedFields, field => this.getLinkedFieldId(field) === fieldId);\n\n\t\tif (!linkedFieldToUpdate) {\n\t\t\tlinkedFieldToUpdate = {\n\t\t\t\tvalue: col.isPicklist ? {} : null\n\t\t\t};\n\t\t}\n\n\t\tif (col.isPicklist) {\n\t\t\tlinkedFieldToUpdate.value.link = data.value.link;\n\t\t\tlinkedFieldToUpdate.value.title = data.value.title || linkedFieldToUpdate.value.title;\n\t\t} else if (col.dataType === this.FieldTypes.DATE.toString()) {\n\t\t\tlinkedFieldToUpdate.value = data.value ? this.$filter('date')(new Date(data.value), 'yyyy-MM-dd') : null;\n\t\t} else {\n\t\t\tlinkedFieldToUpdate.value = data.value;\n\t\t}\n\n\t\tif (!linkedFieldToUpdate.urn && !linkedFieldToUpdate.__self__) {\n\t\t\tlinkedFieldToUpdate.__self__ = col.fieldMetadata.__self__;\n\t\t\tlinkedFieldToUpdate.title = col.fieldMetadata.name;\n\t\t\tlinkedFieldToUpdate.type = col.fieldMetadata.type;\n\t\t\tlinkedFieldToUpdate.urn = col.fieldMetadata.urn;\n\t\t\tlinkedFields.push(linkedFieldToUpdate);\n\t\t}\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getLinkedFieldLink\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the self link of a custom column\n\t *\n\t * @param {Object} field The linked field of an item\n\t *\n\t * @return {String} Self link of a custom column\n\t */\n\tgetLinkedFieldLink: function (field) {\n\t\treturn field.__self__;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getLinkedFieldUrn\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the urn of a custom column\n\t *\n\t * @param {Object} field The linked field of an item\n\t *\n\t * @return {String} Field urn of a custom column\n\t */\n\tgetLinkedFieldUrn: function (field) {\n\t\treturn field.urn;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getLinkedFieldId\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the field ID of a custom column\n\t *\n\t * @param {Object} field The linked field of an item\n\t *\n\t * @return {String} Field ID of a custom column\n\t */\n\tgetLinkedFieldId: function (field) {\n\t\treturn field.urn && field.urn.split('.').pop();\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#getLinkedFieldDataTypeId\n\t * @methodOf Models.AffectedItem\n\t * @description Returns the data type ID of a custom column\n\t *\n\t * @param {Object} field The linked field of an item\n\t *\n\t * @return {String} Data type ID of a custom column\n\t */\n\tgetLinkedFieldDataTypeId: function (field) {\n\t\treturn field.type.urn && field.type.urn.split('.').pop();\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#save\n\t * @methodOf Models.AffectedItem\n\t * @description Updates this item\n\t *\n\t * @returns {Promise} The put request promise\n\t */\n\tsave: function () {\n\t\tvar that = this;\n\t\tvar data = this.getObject();\n\t\tvar url = this.getSelfLink();\n\t\tvar headers = {\n\t\t\t'Content-Type': 'application/json',\n\t\t\tETag: this.getETag()\n\t\t};\n\t\tvar options = {};\n\n\t\treturn this.RESTWrapperService.put(data, url, null, {}, headers, options);\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.AffectedItem#delete\n\t * @methodOf Models.AffectedItem\n\t * @description Deletes this item\n\t *\n\t * @returns {Promise} The delete request promise (currently a fake promise)\n\t */\n\tdelete: function (selfLink) {\n\t\tvar that = this;\n\t\tvar options = {};\n\n\t\treturn this.RESTWrapperService.delete(selfLink.substr(1), null, null, {'Content-Type': 'application/json'}, options);\n\t}\n};\n\nangular.module('plm360.models').factory('AffectedItem', [\n\t'$filter',\n\t'RESTWrapperService',\n\t'EventService',\n\t'$q',\n\t'FieldTypes',\n\tfunction ($filter, RESTWrapperService, EventService, $q, FieldTypes) {\n\t\tvar models = {};\n\t\tAffectedItem.prototype.RESTWrapperService = RESTWrapperService;\n\t\tAffectedItem.prototype.$q = $q;\n\t\tAffectedItem.prototype.$filter = $filter;\n\t\tAffectedItem.prototype.FieldTypes = FieldTypes;\n\n\t\t// Get\n\t\tEventService.listen('affectedItem:*:get', function (event, url, eTag) {\n\t\t\tvar model = models[url] || new AffectedItem();\n\t\t\tmodels[url] = model;\n\t\t\tmodel.fetch(url, eTag).then(function (obj) {\n\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\n\t\t// Save\n\t\tEventService.listen('affectedItem:*:saveItem', function (event, obj) {\n\t\t\tobj.save().then(function () {\n\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':saveDone', true);\n\t\t\t}, function (error) {\n\t\t\t\tif (error.status === 409) {\n\t\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':saveConflict');\n\t\t\t\t} else {\n\t\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':saveDone', false, error);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// Delete\n\t\tEventService.listen('affectedItem:*:deleteItem', function (event, selfLink) {\n\t\t\tvar model = new AffectedItem();\n\t\t\tmodel.delete(selfLink).then(function () {\n\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':deleteDone', true);\n\t\t\t}, function () {\n\t\t\t\t// TODO support for concurrency?\n\t\t\t\tEventService.send('affectedItem:' + event.split(':')[1] + ':deleteDone', false);\n\t\t\t});\n\t\t});\n\n\t\treturn AffectedItem;\n\t}\n]);\n"]}