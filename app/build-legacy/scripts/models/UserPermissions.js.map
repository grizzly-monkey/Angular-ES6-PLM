{"version":3,"sources":["../../../scripts/models/UserPermissions.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;;;;AAab,IAAI,eAAe,GAAG,SAAlB,eAAe,GAAe,EACjC,CAAC;;AAEF,eAAe,CAAC,SAAS,GAAG;;;;;;;;;;;AAW3B,MAAK,EAAE,eAAU,IAAI,EAAE;AACtB,MAAI,IAAI,GAAG,IAAI,CAAC;AAChB,MAAI,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC;AAC/B,MAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,OAAO,EAAE;AACzE,OAAI,CAAC,IAAI,GAAG,OAAO,CAAC;AACpB,WAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;GACvB,CAAC,CAAC;AACH,SAAO,QAAQ,CAAC,OAAO,CAAC;EACxB;;;;;;;;;;;;AAYD,cAAa,EAAE,uBAAU,IAAI,EAAE;AAC9B,MAAI,GAAG,GAAG,KAAK,CAAC;;AAEhB,MAAI,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;AAC1B,OAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,UAAU,UAAU,EAAE;AACxD,QAAI,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,KAAK,IAAI,EAAE;AACvF,QAAG,GAAG,IAAI,CAAC;KACX;IACD,CAAC,CAAC;GACH;AACD,SAAO,GAAG,CAAC;EACX;CACD,CAAC;;AAEF,OAAO,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,OAAO,CAAC,iBAAiB,EAAE,CAC1D,oBAAoB,EACpB,cAAc,EACd,IAAI,EACJ,GAAG,EACH,UAAU,kBAAkB,EAAE,YAAY,EAAE,EAAE,EAAE,CAAC,EAAE;AAClD,KAAI,MAAM,GAAG,EAAE,CAAC;AAChB,gBAAe,CAAC,SAAS,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;AAClE,gBAAe,CAAC,SAAS,CAAC,EAAE,GAAG,EAAE,CAAC;AAClC,gBAAe,CAAC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC;AAChC,aAAY,CAAC,MAAM,CAAC,uBAAuB,EAAE,UAAU,KAAK,EAAE,MAAM,EAAE;AACrE,MAAI,KAAK,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,IAAI,eAAe,EAAE,CAAC;AACpD,QAAM,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC;AACvB,OAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAU,GAAG,EAAE;AACvC,eAAY,CAAC,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,EAAE,GAAG,CAAC,CAAC;GAC3E,CAAC,CAAC;EACH,CAAC,CAAC;AACH,QAAO,eAAe,CAAC;CACvB,CACD,CAAC,CAAC","file":"UserPermissions.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.UserPermissions\n *\n * @description This class wraps a user permissions payload into an object\n *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar UserPermissions = function () {\n};\n\nUserPermissions.prototype = {\n\t/**\n\t * @ngdoc method\n\t * @name Models.UserPermissions#fetch\n\t * @methodOf Models.UserPermissions\n\t * @description Make a call to fetch raw data\n\t *\n\t * @param {String} link The URL to use for fetching the data\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tfetch: function (link) {\n\t\tvar that = this;\n\t\tvar deferred = this.$q.defer();\n\t\tthis.RESTWrapperService.get(link, null, null, {}).then(function (payload) {\n\t\t\tthat.json = payload;\n\t\t\tdeferred.resolve(that);\n\t\t});\n\t\treturn deferred.promise;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.UserPermissions#hasPermission\n\t * @methodOf Models.UserPermissions\n\t * @description Returns whether the permission is in the object\n\t *\n\t * @param {Number} perm The permission to be checked (@see plm360.permissions.PLMPermissions)\n\t *\n\t * @returns {Boolean} True if the permission exists\n\t */\n\thasPermission: function (perm) {\n\t\tvar ret = false;\n\n\t\tif (this.json.permissions) {\n\t\t\tthis._.each(this.json.permissions, function (permission) {\n\t\t\t\tif (parseInt(permission.link.substring(permission.link.lastIndexOf('/') + 1)) === perm) {\n\t\t\t\t\tret = true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn ret;\n\t}\n};\n\nangular.module('plm360.models').factory('UserPermissions', [\n\t'RESTWrapperService',\n\t'EventService',\n\t'$q',\n\t'_',\n\tfunction (RESTWrapperService, EventService, $q, _) {\n\t\tvar models = {};\n\t\tUserPermissions.prototype.RESTWrapperService = RESTWrapperService;\n\t\tUserPermissions.prototype.$q = $q;\n\t\tUserPermissions.prototype._ = _;\n\t\tEventService.listen('userPermissions:*:get', function (event, params) {\n\t\t\tvar model = models[params] || new UserPermissions();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.fetch(params).then(function (obj) {\n\t\t\t\tEventService.send('userPermissions:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\t\treturn UserPermissions;\n\t}\n]);\n"]}