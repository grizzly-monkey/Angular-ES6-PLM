{"version":3,"sources":["../../../scripts/models/Item.js"],"names":[],"mappings":"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","file":"Item.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.Item\n *\n * @description This class wraps an item payload into an object\n *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar Item = function () {\n\tvar that = this;\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#fetch\n\t * @methodOf Models.Item\n\t * @description Make a call to fetch raw data\n\t *\n\t * @param {String} link The URL to use for fetching the data\n\t * @param {Object} workspaceObj The workspace object\n\t * @param {Boolean} isEdit The flag for edit mode\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tthis.fetch = function (link, isEdit) {\n\t\tvar that = this;\n\t\tvar deferred = this.$q.defer();\n\n\t\tvar parsedLink = link;\n\n\t\tif (link.indexOf('`') !== -1) {\n\t\t\tparsedLink = this.UrnParser.decode(link);\n\t\t} else if (link.indexOf('@') !== -1) {\n\t\t\tvar ids = link.split('@');\n\t\t\tparsedLink = 'workspaces/' + ids[0] + '/items/' + ids[1];\n\t\t}\n\n\t\tthis.RESTWrapperService.get('api/v3/' + parsedLink, null, null, {}).then(function (payload) {\n\t\t\tvar promises = [];\n\t\t\tthat._.each(payload.sections, function (section) {\n\t\t\t\tthat._.each(section.fields, function (field) {\n\n\t\t\t\t\t// Set data type id\n\t\t\t\t\tfield.metadata = {dataTypeId: parseInt(field.type.link.substring(field.type.link.lastIndexOf('/') + 1))};\n\t\t\t\t\tif (that._.isArray(field.value)) {\n\t\t\t\t\t\tthat._.each(field.value, function (value) {\n\t\t\t\t\t\t\tif (angular.isDefined(value.item)) {\n\t\t\t\t\t\t\t\tvar localDeferred = that.$q.defer();\n\t\t\t\t\t\t\t\tpromises.push(localDeferred.promise);\n\t\t\t\t\t\t\t\tthat.RESTWrapperService.get(value.item.substring(1), null, null, {hideError: true}).then(function (itemPayload) {\n\t\t\t\t\t\t\t\t\tvalue.id = itemPayload.id;\n\t\t\t\t\t\t\t\t\tvalue.workspaceId = itemPayload.workspaceId;\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (that._.isObject(value) && angular.isDefined(value.link) && value.link.indexOf('/items/') > -1) {\n\t\t\t\t\t\t\t\tvar localDeferred = that.$q.defer();\n\t\t\t\t\t\t\t\tpromises.push(localDeferred.promise);\n\t\t\t\t\t\t\t\tthat.RESTWrapperService.get(value.link.substring(1), null, null, {hideError: true}).then(function (itemPayload) {\n\t\t\t\t\t\t\t\t\tvalue.resourceId = that.UrnParser.encode(itemPayload.urn);\n\t\t\t\t\t\t\t\t\t// Note: the generic picklist widget is not using these deleted/revision attributes\n\t\t\t\t\t\t\t\t\tif (angular.isDefined(itemPayload.deleted)) {\n\t\t\t\t\t\t\t\t\t\tvalue.deleted = itemPayload.deleted;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (angular.isDefined(itemPayload.version)) {\n\t\t\t\t\t\t\t\t\t\tthat.RESTWrapperService.get('api/v3/configurations/preVersionDescriptorText', null, null, {}).then(function (preTextPayload) {\n\t\t\t\t\t\t\t\t\t\t\tthat.RESTWrapperService.get('api/v3/configurations/postVersionDescriptorText', null, null, {}).then(function (postTextPayload) {\n\t\t\t\t\t\t\t\t\t\t\t\tvalue.revision = (itemPayload.workingVersion ? '(' + itemPayload.version + ')' : preTextPayload.value + itemPayload.version + postTextPayload.value);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (that._.isObject(field.value)) {\n\t\t\t\t\t\t// TODO: workaround for waiting for implementation of endpoint\n\t\t\t\t\t\tif (angular.isDefined(field.value.link) && field.value.link.indexOf('/items/') > -1) {\n\n\t\t\t\t\t\t\t// Except FLASH and IMAGE field types - the link is actually not a link to a payload,\n\t\t\t\t\t\t\t// but to a data stream (despite being a link to /api/v2/...)\n\t\t\t\t\t\t\tif ((field.metadata.dataTypeId !== 21) && (field.metadata.dataTypeId !== 15)) {\n\t\t\t\t\t\t\t\tvar localDeferred = that.$q.defer();\n\t\t\t\t\t\t\t\tpromises.push(localDeferred.promise);\n\t\t\t\t\t\t\t\tthat.RESTWrapperService.get(field.value.link.substring(1), null, null, {hideError: true}).then(function (itemPayload) {\n\t\t\t\t\t\t\t\t\tfield.value.resourceId = that.UrnParser.encode(itemPayload.urn);\n\t\t\t\t\t\t\t\t\tif (angular.isDefined(itemPayload.deleted)) {\n\t\t\t\t\t\t\t\t\t\tfield.value.deleted = itemPayload.deleted;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (angular.isDefined(itemPayload.version)) {\n\t\t\t\t\t\t\t\t\t\tthat.RESTWrapperService.get('api/v3/configurations/preVersionDescriptorText', null, null, {}).then(function (preTextPayload) {\n\t\t\t\t\t\t\t\t\t\t\tthat.RESTWrapperService.get('api/v3/configurations/postVersionDescriptorText', null, null, {}).then(function (postTextPayload) {\n\t\t\t\t\t\t\t\t\t\t\t\tfield.value.revision = (itemPayload.workingVersion ? '(' + itemPayload.version + ')' : preTextPayload.value + itemPayload.version + postTextPayload.value);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t}, function () {\n\t\t\t\t\t\t\t\t\tlocalDeferred.resolve();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthat.$q.all(promises).then(function () {\n\t\t\t\tthat.json = payload;\n\n\t\t\t\tthat.json.id = payload.__self__.substring(payload.__self__.lastIndexOf('/') + 1);\n\n\t\t\t\tthat.transitions = {\n\t\t\t\t\t// TODO: the workflow id is default to '1' but in future to support muliple workflows, we need to revisit this link.\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/workflows/1/transitions'\n\t\t\t\t};\n\n\t\t\t\tthat.revisions = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/versions'\n\t\t\t\t};\n\n\t\t\t\tthat.changelog = {\n\t\t\t\t\tlink: 'api/v2/workspaces/[workspaceId]/items/' + that.json.id + '/logs'\n\t\t\t\t};\n\n\t\t\t\tthat.workflow = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/2'\n\t\t\t\t};\n\n\t\t\t\tthat.gridmeta = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/13/fields'\n\t\t\t\t};\n\n\t\t\t\tthat.affectedmeta = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/11/fields'\n\t\t\t\t};\n\n\t\t\t\tthat.grid = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/13/rows'\n\t\t\t\t};\n\n\t\t\t\tthat.affectedItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/11'\n\t\t\t\t};\n\n\t\t\t\tthat.affectedItemsAssociation = {\n\t\t\t\t\tlink: '/workspaces/[workspaceId]/items/[itemId]'\n\t\t\t\t};\n\n\t\t\t\tthat.affectedItemLinkableItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/11/linkable-items'\n\t\t\t\t};\n\n\t\t\t\tthat.projectItemLinkableItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/16/linkable-items'\n\t\t\t\t};\n\n\t\t\t\tthat.relationshipItemLinkableItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/10/linkable-items'\n\t\t\t\t};\n\n\t\t\t\tthat.bomItemLinkableItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/5/linkable-items'\n\t\t\t\t};\n\n\t\t\t\tthat.namedRelationshipLinkableItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' +\n\t\t\t\t\t\tthat.json.id +\n\t\t\t\t\t\t'/relationships/[namedRelationshipId]/range'\n\t\t\t\t};\n\n\t\t\t\tthat.relatedItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/10'\n\t\t\t\t};\n\n\t\t\t\tthat.relatedBomItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/bom-items?limit=999&revisionBias=working'\n\t\t\t\t};\n\n\t\t\t\tthat.namedRelationships = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/relationships/[namedRelationshipsKey]'\n\t\t\t\t};\n\n\t\t\t\tthat.whereUsed = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/where-used?limit=999&revisionBias=working'\n\t\t\t\t};\n\n\t\t\t\tthat.projectItems = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/16'\n\t\t\t\t};\n\n\t\t\t\tthat.milestones = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/17'\n\t\t\t\t};\n\n\t\t\t\tthat.actionNotifications = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/4/notifications'\n\t\t\t\t};\n\n\t\t\t\tthat.ownership = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id\n\t\t\t\t};\n\n\t\t\t\tthat.sourcings = {\n\t\t\t\t\tlink: 'api/v3/workspaces/[workspaceId]/items/' + that.json.id + '/views/8/sourcings'\n\t\t\t\t};\n\n\t\t\t\t// that.workspaceObj = workspaceObj;\n\n\t\t\t\tdeferred.resolve(that);\n\t\t\t});\n\t\t}, function (err) {\n\t\t\tdeferred.reject(err);\n\t\t});\n\n\t\treturn deferred.promise;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getFullList\n\t * @methodOf Models.Item\n\t * @description Returns the full list of data\n\t *\n\t * @returns {Array} The full list of data\n\t *\n\t */\n\tthis.getFullList = function () {\n\t\treturn this.json;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getRootId\n\t * @methodOf Models.Item\n\t * @description Returns root id of the item\n\t *\n\t * @returns {Number} The root id of the item\n\t */\n\tthis.getRootId = function () {\n\t\treturn this.json.rootId;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getId\n\t * @methodOf Models.Item\n\t * @description Returns dms id of the item\n\t *\n\t * @returns {Number} The dms id of the item\n\t *\n\t */\n\tthis.getId = function () {\n\t\treturn this.json ? this.json.id : 0;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getSections\n\t * @methodOf Models.Item\n\t * @description Returns sections of this item\n\t *\n\t * @returns {Array} The sections of this item\n\t */\n\tthis.getSections = function () {\n\t\treturn this.json.sections;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getItemDescriptor\n\t * @methodOf Models.Item\n\t * @description Returns the descriptor of the item\n\t *\n\t * @returns {String} The descriptor of the item\n\t */\n\tthis.getItemDescriptor = function () {\n\t\treturn this.json.itemDescriptor;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getItemTitle\n\t * @methodOf Models.Item\n\t * @description Returns the descriptor of the item\n\t *\n\t * @returns {String} The descriptor of the item\n\t */\n\tthis.getItemTitle = function () {\n\t\treturn this.json.title;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getItemVersion\n\t * @methodOf Models.Item\n\t * @description Returns the version of the item\n\t *\n\t * @returns {String} The version of the item\n\t */\n\tthis.getItemVersion = function () {\n\t\treturn this.json.version;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#setQ\n\t * @methodOf Models.Item\n\t * @description Sets q object\n\t *\n\t * @param {Object} q The q object\n\t */\n\tthis.setQ = function (q) {\n\t\tthis.q = q;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getOwnershipLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the ownership info for the item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getOwnershipLink = function () {\n\t\treturn this.ownership.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getTransitionsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the transitions for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getTransitionsLink = function () {\n\t\treturn this.transitions.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getChangeLogLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the changelog for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getChangeLogLink = function () {\n\t\treturn this.changelog.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getWorkflowLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the workflow for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getWorkflowLink = function () {\n\t\treturn this.workflow.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getActionNotificationsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the actionnotifications for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getActionNotificationsLink = function () {\n\t\treturn this.actionNotifications.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#setActionNotifications\n\t * @methodOf Models.Item\n\t * @description Attaches the actionnotifications object to the tree\n\t *\n\t * @param {Object} obj The actionnotifications object\n\t */\n\tthis.setActionNotifications = function (obj) {\n\t\tthis.actionNotifications.obj = obj;\n\t};\n\n\t/**\n\t * @name Models.Item#getGridLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the grid for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getGridLink = function () {\n\t\treturn this.grid.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @name Models.Item#getBomNestedLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link bom meta details for the item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getBomNestedLink = function () {\n\t\treturn this.json.nestedBom !== null ? this.json.nestedBom.link.replace(/^\\//, '') : null;\n\t};\n\n\t/**\n\t * @name Models.Item#getBomRootLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the bom root item details\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getBomRootLink = function () {\n\t\treturn this.json.bom !== null ? this.json.bom.link.replace(/^\\//, '') : null;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getAffectedItemsMetaLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the gridmeta for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getAffectedItemsMetaLink = function () {\n\t\treturn this.affectedmeta.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getGridMetaLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the gridmeta for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getGridMetaLink = function () {\n\t\treturn this.gridmeta.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getLinkedItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the affected items for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getAffectedItemsLink = function () {\n\t\treturn this.affectedItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getAffectedItemTransitionsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the affected items for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getAffectedItemTransitionsLink = function (itemId) {\n\t\treturn this.affectedItems.link.replace('[workspaceId]', this.workspaceObj.getId()) + '/affected-items/' + itemId + '/transitions';\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getRelatedItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the related items for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getRelatedItemsLink = function () {\n\t\treturn this.relatedItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getRelatedBomItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the related BOM items for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getRelatedBomItemsLink = function () {\n\t\treturn this.relatedBomItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getNamedRelationshipsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the named relationships for item\n\t *\n\t * @param {String} namedRelationshipsKey: the key to differentiate the different namedRelationships\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getNamedRelationshipsLink = function (namedRelationshipsKey) {\n\t\treturn this.namedRelationships.link.replace('[workspaceId]', this.workspaceObj.getId())\n\t\t\t.replace('[namedRelationshipsKey]', namedRelationshipsKey);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getWhereUsedLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the where-used for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getWhereUsedLink = function () {\n\t\treturn this.whereUsed.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getSourcingsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for retrieving the sourcings of an item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getSourcingsLink = function () {\n\t\treturn this.sourcings.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getRevisionsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the transitions for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getRevisionsLink = function () {\n\t\treturn this.revisions.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#setWorkspaceObj\n\t * @methodOf Models.Item\n\t * @description Sets workspace object\n\t *\n\t * @param {Object} workspaceObj The workspace object\n\t */\n\tthis.setWorkspaceObj = function (workspaceObj) {\n\t\tthis.workspaceObj = workspaceObj;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getWorkspaceObj\n\t * @methodOf Models.Item\n\t * @description Returns the workspaceObj from this item\n\t *\n\t * @return {Object} workspaceObj The workspace object\n\t */\n\tthis.getWorkspaceObj = function (workspaceObj) {\n\t\treturn angular.copy(this.workspaceObj);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getItemDetailsOptionsData\n\t * @methodOf Models.Item\n\t * @description Returns the options values for field\n\t *\n\t * @param \t{String} \t\tfieldType\t \tThe field type that needs info to be retrieved from\n\t *\n\t * @returns {Object} \t\t\t\tA promise, and when resolved, the GET response\n\t */\n\tthis.getItemDetailsOptionsData = function (fieldType) {\n\t\treturn this.RESTWrapperService.get('api/v2', [{\n\t\t\tworkspaces: this.workspaceObj.getId(),\n\t\t\t'item-fields': fieldType\n\t\t}, 'values']);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#setBookmark\n\t * @methodOf Models.Item\n\t * @description Adds/remove a bookmarked item to the list\n\t *\n\t * @param \t{Boolean} \tflag\t\tIf the item should be added (true) or removed (false)\n\t *\n\t * @returns {Object} \t\t\t\tA promise, and when resolved, the PUT/DELETE response\n\t */\n\tthis.setBookmark = function (flag) {\n\t\tif (flag) {\n\t\t\treturn this.RESTWrapperService.put(' ', 'api/rest/v1/users/current_user', [{\n\t\t\t\tbookmarks: this.json.id\n\t\t\t}], null, {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}, {});\n\t\t} else {\n\t\t\treturn this.RESTWrapperService.delete('api/rest/v1/users/current_user', [{\n\t\t\t\tbookmarks: this.json.id\n\t\t\t}], null, {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}, {});\n\t\t}\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#setArchive\n\t * @methodOf Models.Item\n\t * @description Archirve/Unarchive item to the list\n\t *\n\t * @param \t{Boolean} \tflag\t\tIf the item should be added (true) or removed (false)\n\t *\n\t * @returns {Object} \t\t\t\tA promise, and when resolved, the PUT/DELETE response\n\t */\n\tthis.setArchive = function (flag) {\n\t\tif (flag) {\n\t\t\treturn this.RESTWrapperService.patch('', 'api/v3', [{\n\t\t\t\tworkspaces: this.workspaceObj.getId(),\n\t\t\t\titems: this.json.id\n\t\t\t}], {\n\t\t\t\tdeleted: true\n\t\t\t}, {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}, {});\n\t\t} else {\n\t\t\treturn this.RESTWrapperService.patch('', 'api/v3', [{\n\t\t\t\tworkspaces: this.workspaceObj.getId(),\n\t\t\t\titems: this.json.id\n\t\t\t}], {\n\t\t\t\tdeleted: false\n\t\t\t}, {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}, {});\n\t\t}\n\t\tthis.json.deleted = flag;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#performTransition\n\t * @methodOf Models.Item\n\t * @description Performs the transition given transition ID\n\t *\n\t * @param \t{Object} \t\ttransitionObj\tThe object representing the transition to be performed.\n\t * @param \t{String}\t\tcomments\t\tComments of the transition step. This can be optional depending upon the configuration.\n\t * @param   {Object}        selectedUserImpersonation   The object represent the user with which the transition is performed. This is an optional parameter.\n\t *\n\t * @returns {Object} \t\tA promise of the POST request\n\t *\n\t * TODO support for password\n\t */\n\tthis.performTransition = function (transitionObj, comments, selectedUserImpersonation) {\n\t\tvar data = {\n\t\t\tcomment: comments || ''\n\t\t};\n\n\t\tif (selectedUserImpersonation) {\n\t\t\tdata.impersonation = {\n\t\t\t\tlink: selectedUserImpersonation.link\n\t\t\t};\n\t\t}\n\n\t\treturn this.RESTWrapperService.post(data, 'api/v3', [{\n\t\t\t\tworkspaces: this.workspaceObj.getId(),\n\t\t\t\titems: this.json.id,\n\t\t\t\tworkflows: 1\n\t\t\t}, 'transitions'],\n\t\t\tnull, {\n\t\t\t\tAccept: 'application/json',\n\t\t\t\t'Content-Location': transitionObj.__self__\n\t\t\t}, {});\n\t};\n\n\t/*\n\t * Helper function to parse the field and prepare it for the endpoint, modifying 'dataToPut'\n\t */\n\tthis.prepareFieldForEndpoint = function (field) {\n\t\tvar fieldValue;\n\t\tswitch (field.metadata.dataTypeId) {\n\t\t\t// JUST ASSIGNING THE EXISTING VALUES FOR NOW, SINCE WE DON'T HAVE THE EDIT OF THIS TYPE\n\t\tcase 10: // radio\n\t\tcase 25: // radio linked\n\t\tcase 6: // picklist first default\n\t\tcase 7: // picklist linked first default\n\t\tcase 13: // multi select\n\t\tcase 20: // picklist\n\t\tcase 22: // picklist latest version\n\t\tcase 23: // picklist linked\n\t\tcase 24: // picklist lrl\n\t\tcase 26: // PLF\n\t\tcase 27: // multi select linked\n\t\tcase 28: // uom\n\t\tcase 29: // FPL\n\t\t\t// case 'SELECT_LIST':\n\t\t\t// case 'MULTI_SELECT':\n\t\t\t// case 'PICK_LIST_FILTER':\n\t\t\t// case 'PICK_LIST_RADIO' :\n\t\t\t// case 'PICK_LIST_FIRST_VALUE_DEFAULT':\n\t\t\t// case 'PICK_LIST_MULTI_SELECT':\n\t\t\t// case 'PICK_LIST_SEARCH_FILTER':\n\t\t\t// case 'PICK_LIST':\n\t\t\t// case 'BOM_UNITS_PICK_LIST':\n\n\t\t\t// breaks off in case data is inconsistent\n\t\t\t// if (!angular.isArray(field.value)) {\n\t\t\t// \tthat.$log.error('Despite being a picklist, value is NOT an array! Cannot proceed!')\n\t\t\t// \tbreak;\n\t\t\t// }\n\n\t\t\t// resets the array (in case no value has been selected, it will be left as empty, which is the expected format from the endpoint)\n\t\t\tfieldValue = field.value;\n\n\t\t\tbreak;\n\t\tcase 9: // booleans have to be converted properly to something that the endpoint accepts\n\t\t\tfieldValue = (field.value === 'true' || field.value === true) ? 'true' : 'false';\n\t\t\tbreak;\n\t\tcase 3: // dates have to be formatted in a way so that they're accepted by the endpoint\n\t\t\t// Strip out the timezone information, because we're not saving this info in the backend\n\t\t\tif ((field.value !== '') && (field.value !== null)) {\n\t\t\t\tif (field.value.constructor === Date) { // Parse the date, to make it endpoint-friendly\n\t\t\t\t\tfieldValue = that.$filter('date')(Date.parse(field.value), 'yyyy-MM-dd');\n\t\t\t\t} else {\n\t\t\t\t\tfieldValue = field.value; // We assign anyway the existent value, as in the rest of data\n\t\t\t\t}\n\t\t\t} else { // handle empty date fields, setting them as null so the endpoint accepts them (same logic as below)\n\t\t\t\tfieldValue = null;\n\t\t\t}\n\t\t\tbreak;\n\t\t\t// DISABLED FOR NOW, SINCE WE DON'T HAVE THE EDIT OF THIS TYPE\n\t\t\t// case 'IMAGE': // images should be the URL, but might change in the future with CPDM\n\t\t\t// break;\n\t\tdefault: // everything else\n\t\t\tfieldValue = (field.value === '') ? null : field.value; // empty values are not accepted by the endpoint, they should be null\n\n\t\t\tbreak;\n\t\t}\n\n\t\treturn fieldValue;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#saveNew\n\t * @methodOf Models.Item\n\t * @description Creates a new workspace item\n\t *\n\t * @param \t{String} workspaceId    The workspace id for which a new item will be created.\n\t * @param \t{Array} newItemData\t\tAn array of sections of the workspace.\n\t *\n\t * @returns {Object} A promise holding the POST request\n\t *\n\t * TODO: does it make sense to move this to workspace model ?\n\t */\n\tthis.saveNew = function (workspaceId, newItemData) {\n\t\tvar that = this;\n\n\t\tvar payloadBuilder = new this.CreateItemPayloadBuilder(newItemData, _);\n\t\t_.chain(newItemData)\n\t\t\t.pluck('fields')\n\t\t\t.flatten(true)\n\t\t\t.filter(field => (angular.isDefined(field) && (field !== null)))\n\t\t\t.each((field) => payloadBuilder.addFieldValue(field.__self__, that.prepareFieldForEndpoint(field)));\n\n\t\tvar dataToPost = payloadBuilder.getPayload();\n\n\t\treturn this.RESTWrapperService.post(dataToPost, 'api/v3', [{\n\t\t\tworkspaces: workspaceId\n\t\t}, 'items'], null, {\n\t\t\t'Content-Type': 'application/json'\n\t\t}, {});\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#save\n\t * @methodOf Models.Item\n\t * @description Saves the data containing the workspace item details information\n\t *\n\t * @param \t{Object}\t\t\tmodifiedData \t\t\t\tThe data that needs to be PUT\n\t *\n\t * @returns {Object} \t\tA promise of the PUT request\n\t */\n\tthis.save = function (modifiedData) {\n\t\tvar that = this;\n\n\t\t// copies the returned data to a new object, that's going to be modified\n\t\tvar dataToPut = {};\n\t\tObject.assign(dataToPut, this.getFullList().originalElement);\n\n\t\t// retrieved data successfully, now modify it according to the supplied data (which is structured differently\n\t\t// than what's expected by the endpoint - refer to 'getItemDetailsFields'\n\n\t\t// first loop, through each section present in the object\n\t\t_.each(modifiedData, function (section, sectionIndex) {\n\n\t\t\t// second loop, through all the elements\n\t\t\t_.each(section.fields, function (field, fieldIndex) {\n\t\t\t\tif (angular.isDefined(field) && (field !== null)) {\n\t\t\t\t\tvar payloadField = dataToPut.sections[sectionIndex].fields[fieldIndex];\n\t\t\t\t\tpayloadField.value = that.prepareFieldForEndpoint(field);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// PUTs the content, returns the promise to the chain\n\t\treturn this.RESTWrapperService.put(dataToPut, 'api/v3', [{\n\t\t\tworkspaces: this.workspaceObj.getId(),\n\t\t\titems: this.json.id\n\t\t}], null, {\n\t\t\t// TODO: This should not be necessary since Restangular says that it works with etags out-of-the-box\n\t\t\t// Something happens between retrieving the resource with its correct etag and the update, that breaks the link\n\t\t\t// and the If-Match header is not sent automatically.\n\t\t\t'If-Match': this.json.restangularEtag\n\t\t}, {}).then(function (res) {\n\t\t\t// update the local copy of the json with the response, because the this.json above doesn't have the latest data\n\t\t\tthat.json = res;\n\t\t});\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getAffectedItemLinkableItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the linkable items for an affected item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t *\n\t */\n\tthis.getAffectedItemLinkableItemsLink = function () {\n\t\treturn this.affectedItemLinkableItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getProjectItemLinkableItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the linkable items for a project item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getProjectItemLinkableItemsLink = function () {\n\t\treturn this.projectItemLinkableItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getRelationshipItemLinkableItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the linkable items for a relationship item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getRelationshipItemLinkableItemsLink = function () {\n\t\treturn this.relationshipItemLinkableItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getBomItemLinkableItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the linkable items for a bom item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getBomItemLinkableItemsLink = function () {\n\t\treturn this.bomItemLinkableItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getNamedRelationshipItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the linkable items for a named relationship item\n\t *\n\t * @param {String} namedRelationshipId The id for the named relationship\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getNamedRelationshipItemsLink = function (namedRelationshipId) {\n\t\treturn this.namedRelationshipLinkableItems.link\n\t\t\t.replace('[workspaceId]', this.workspaceObj.getId())\n\t\t\t.replace('[namedRelationshipId]', namedRelationshipId);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#associateAffectedItem\n\t * @methodOf Models.Item\n\t * @description Associates an affected item with this item\n\t *\n\t * @param {String} locationUrl: the url of the new item. Note: This is necessary to link the items.\n\t * @param {String} itemDescription: the item description that will be displayed on the save event.\n\t *\n\t * @return {Object} A promise of the POST request.\n\t */\n\tthis.associateAffectedItem = function (locationUrl, itemDescriptor) {\n\t\tvar that = this;\n\t\treturn this.RESTWrapperService.post(null, 'api/v3', [{\n\t\t\t\tworkspaces: that.workspaceObj.getId()\n\t\t\t}, {\n\t\t\t\titems: that.json.id\n\t\t\t}, 'affected-items'],\n\t\t\tnull, {\n\t\t\t\tAccept: 'application/json',\n\t\t\t\t'Content-Location': locationUrl\n\t\t\t}, {});\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#associateProjectItem\n\t * @methodOf Models.Item\n\t * @description Associates a project item with this item\n\t *\n\t * @param {String} locationUrl: the url of the new item. Note: This is necessary to link the items.\n\t * @param {String} itemDescription: the item description that will be displayed on the save event.\n\t *\n\t * @return {Object} A promise of the POST request.\n\t */\n\tthis.associateProjectItem = function (locationUrl, itemDescriptor) {\n\t\tvar that = this;\n\n\t\tvar data = null;\n\t\tvar base = 'api/v3';\n\t\tvar path = [\n\t\t\t{\n\t\t\t\tworkspaces: that.workspaceObj.getId()\n\t\t\t},\n\t\t\t{\n\t\t\t\titems: that.json.id\n\t\t\t},\n\t\t\t'views/16'\n\t\t];\n\t\tvar params = null;\n\t\tvar headers = {\n\t\t\t'Content-Location': locationUrl\n\t\t};\n\t\tvar options = {};\n\n\t\treturn this.RESTWrapperService.post(data, base, path, params, headers, options);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#associateRelationshipItem\n\t * @methodOf Models.Item\n\t * @description Associates a relationship item with this item\n\t *\n\t * @param {String} locationUrl: the url of the new item. Note: This is necessary to link the items.\n\t * @param {String} itemDescription: the item description that will be displayed on the save event.\n\t *\n\t * @return {Object} A promise of the POST request.\n\t */\n\tthis.associateRelationshipItem = function (locationUrl, itemDescriptor) {\n\t\tvar that = this;\n\n\t\t// TODO This is hardcoded data - in the future the user will have the\n\t\t// ability to provide these values\n\t\tvar data = {\n\t\t\tdirection: {\n\t\t\t\ttype: 'Uni-Directional'\n\t\t\t},\n\t\t\tdescription: ''\n\t\t};\n\t\tvar base = 'api/v3';\n\t\tvar path = [\n\t\t\t{\n\t\t\t\tworkspaces: that.workspaceObj.getId()\n\t\t\t},\n\t\t\t{\n\t\t\t\titems: that.json.id\n\t\t\t},\n\t\t\t'views/10'\n\t\t];\n\t\tvar params = null;\n\t\tvar headers = {\n\t\t\t'Content-Location': locationUrl\n\t\t};\n\t\tvar options = {};\n\n\t\treturn this.RESTWrapperService.post(data, base, path, params, headers, options);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#associateNamedRelationshipItem\n\t * @methodOf Models.Item\n\t * @description Associates a named relationship item with this item\n\t *\n\t * @param {String} locationUrl the url of the new item. Note: This is necessary to link the items.\n\t * @param {String} itemDescription the item description that will be displayed on the save event.\n\t * @param {String} namedRelationshipId The type of named relationship e.g. 'AML'\n\t *\n\t * @return {Object} A promise of the POST request.\n\t */\n\tthis.associateNamedRelationshipItem = function (locationUrl, itemDescriptor, namedRelationshipId) {\n\t\tvar that = this;\n\n\t\tvar data = null;\n\t\tvar base = 'api/v3';\n\t\tvar path = [\n\t\t\t{\n\t\t\t\tworkspaces: that.workspaceObj.getId()\n\t\t\t},\n\t\t\t{\n\t\t\t\titems: that.json.id\n\t\t\t},\n\t\t\t`relationships/${namedRelationshipId}`\n\t\t];\n\t\tvar params = null;\n\t\tvar headers = {\n\t\t\t'Content-Location': locationUrl\n\t\t};\n\t\tvar options = null;\n\n\t\treturn this.RESTWrapperService.post(data, base, path, params, headers, options);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#saveActionNotification\n\t * @methodOf Models.ActionNotification\n\t * @description saves the action notification\n\t *\n\t * @param {Object} itemActionNotification: the action notification object that need to be stored.\n\t *\n\t * @return {Object} A promise of the POST request.\n\t */\n\tthis.saveActionNotification = function (itemActionNotification) {\n\t\tvar that = this;\n\t\treturn this.RESTWrapperService.post(itemActionNotification, 'api/v3', [{\n\t\t\t\tworkspaces: that.workspaceObj.getId()\n\t\t\t}, {\n\t\t\t\titems: that.json.id\n\t\t\t}, 'views/4/notifications'],\n\t\t\tnull, {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t}, {});\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#createAssociationLink\n\t * @methodOf Models.Item\n\t * @description Create link that can be used to associated affected item\n\t *\n\t * @param {String} workspaceId workspace id\n\t * @param {String} itemId id of the item to be associated.\n\t *\n\t * @returns {String} association url\n\t *\n\t * TODO not really use this is the right place for this link. Association link will be used as a 'content-location' header\n\t * to add association between the affected item and the workspace item.\n\t * TODO bit confused about this affected item thing, as logically affected item and linkable item both are just workspace items.\n\t */\n\tthis.getAffectedItemsAssociationLink = function (workspaceId, itemId) {\n\t\treturn this.affectedItemsAssociation.link.replace('[workspaceId]', workspaceId).replace('[itemId]', itemId);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getProjectItemsLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the project management tasks for item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getProjectItemsLink = function () {\n\t\treturn this.projectItems.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getMilestonesLink\n\t * @methodOf Models.Item\n\t * @description Returns the REST api link for the milestones for the item\n\t *\n\t * @returns {String} The string representation of the REST link\n\t */\n\tthis.getMilestonesLink = function () {\n\t\treturn this.milestones.link.replace('[workspaceId]', this.workspaceObj.getId());\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getUrn\n\t * @methodOf Models.Item\n\t * @description Returns the 'urn' attribute\n\t *\n\t *\n\t * @returns {String} The urn associated to the item\n\t */\n\tthis.getUrn = function () {\n\t\treturn that.json.urn;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#isLocked\n\t * @methodOf Models.Item\n\t * @description Returns if the item is locked by workflow state\n\t *\n\t *\n\t * @returns {Boolean} if the item is locked\n\t */\n\tthis.isLocked = function () {\n\t\treturn that.json.itemLocked;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#isWorking\n\t * @methodOf Models.Item\n\t * @description Returns if the item is the working version\n\t *\n\t *\n\t * @returns {Boolean} if the item is working\n\t */\n\tthis.isWorking = function () {\n\t\treturn that.json.workingVersion;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#isReleased\n\t * @methodOf Models.Item\n\t * @description Returns if the item is the a released version\n\t *\n\t *\n\t * @returns {Boolean} if the item is released\n\t */\n\tthis.isReleased = function () {\n\t\treturn !that.json.workingVersion;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.Item#getLifecycleState\n\t * @methodOf Models.Item\n\t * @description Returns the lifecycle state\n\t *\n\t *\n\t * @returns {Object} The lifecycle object\n\t */\n\tthis.getLifecycleState = function () {\n\t\treturn that.json.lifecycle;\n\t};\n};\n\nangular.module('plm360.models').factory('Item', [\n\t'RESTWrapperService',\n\t'EventService',\n\t'ModelsManager',\n\t'UrnParser',\n\t'$filter',\n\t'$q',\n\t'$log',\n\t'_',\n\t'CreateItemPayloadBuilder',\n\tfunction (RESTWrapperService, EventService, ModelsManager, UrnParser, $filter, $q, $log, _, CreateItemPayloadBuilder) {\n\t\tvar models = {};\n\t\tItem.prototype.RESTWrapperService = RESTWrapperService;\n\t\tItem.prototype.ModelsManager = ModelsManager;\n\t\tItem.prototype.UrnParser = UrnParser;\n\t\tItem.prototype.$filter = $filter;\n\t\tItem.prototype.$q = $q;\n\t\tItem.prototype.$log = $log;\n\t\tItem.prototype._ = _;\n\t\tItem.prototype.CreateItemPayloadBuilder = CreateItemPayloadBuilder;\n\n\t\t// get item\n\t\tEventService.listen('itemInstance:*:get', function (event, params, isEdit) {\n\t\t\tvar model = models[params] || new Item();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.fetch(params, isEdit).then(function (obj) {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\t\tEventService.listen('preItemInstance:*:get', function (event, params, isEdit) {\n\t\t\tvar model = models[params] || new Item();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.fetch(params, isEdit).then(function (obj) {\n\t\t\t\tEventService.send('preItemInstance:' + event.split(':')[1] + ':done', obj);\n\t\t\t}, function (err) {\n\t\t\t\tif (err.status === 404) {\n\t\t\t\t\tEventService.send('preItemInstance:' + event.split(':')[1] + ':notFound');\n\t\t\t\t} else {\n\t\t\t\t\tEventService.send('preItemInstance:' + event.split(':')[1] + ':rejected', err);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// set bookmark\n\t\tEventService.listen('itemInstance:*:setBookmark', function (event, obj, flag) {\n\t\t\tobj.setBookmark(flag).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':setBookmarkDone');\n\t\t\t});\n\t\t});\n\n\t\t// set archive\n\t\tEventService.listen('itemInstance:*:setArchive', function (event, obj, flag) {\n\t\t\tobj.setArchive(flag).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':setArchiveDone');\n\t\t\t});\n\t\t});\n\n\t\t// perform transition\n\t\tEventService.listen('itemInstance:*:performTransition', function (event, obj, transitionObj, comments, selectedUserImpersonation, password) {\n\t\t\tobj.performTransition(transitionObj, comments, selectedUserImpersonation, password).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':performTransitionDone', true);\n\t\t\t}, function (error) {\n\t\t\t\tif (error.status === 400) {\n\t\t\t\t\t// Special handling of bad requests.\n\t\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':performTransitionBadRequest', error.data);\n\t\t\t\t} else {\n\t\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':performTransitionDone', false);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t// save\n\t\tEventService.listen('itemInstance:*:saveItem', function (event, obj, data) {\n\t\t\tobj.save(data).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':saveDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':saveDone', false);\n\t\t\t});\n\t\t});\n\n\t\t// save new\n\t\tEventService.listen('itemInstance:newItem:save', function (event, params, workspaceId, data) {\n\t\t\tvar model = models[params] || new Item();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.saveNew(workspaceId, data).then(function (response) {\n\t\t\t\tEventService.send('itemInstance:newItem:saveDone', response, true);\n\t\t\t}, function (error) {\n\t\t\t\tEventService.send('itemInstance:newItem:saveDone', error, false);\n\t\t\t});\n\t\t});\n\n\t\t// associate affected item\n\t\tEventService.listen('itemInstance:*:associateAffectedItem', function (event, obj, locationUrl, itemDescriptor) {\n\t\t\tobj.associateAffectedItem(locationUrl, itemDescriptor).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', false);\n\t\t\t});\n\t\t});\n\n\t\t// associate project item\n\t\tEventService.listen('itemInstance:*:associateProjectItem', function (event, obj, locationUrl, itemDescriptor) {\n\t\t\tobj.associateProjectItem(locationUrl, itemDescriptor).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', false);\n\t\t\t});\n\t\t});\n\n\t\t// associate relationship item\n\t\tEventService.listen('itemInstance:*:associateRelationshipItem', function (event, obj, locationUrl, itemDescriptor) {\n\t\t\tobj.associateRelationshipItem(locationUrl, itemDescriptor).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', false);\n\t\t\t});\n\t\t});\n\n\t\t// associate named relationship item\n\t\tEventService.listen('itemInstance:*:associateNamedRelationshipItem', function (event, obj, locationUrl, itemDescriptor, namedRelationshipId) {\n\t\t\tobj.associateNamedRelationshipItem(locationUrl, itemDescriptor, namedRelationshipId).then(function () {\n\t\t\t\tModelsManager.resetModels();\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':associationDone', false);\n\t\t\t});\n\t\t});\n\n\t\t// action notification save\n\t\tEventService.listen('itemInstance:*:actionNotificationItem', function (event, obj, itemActionNotification) {\n\t\t\tobj.saveActionNotification(itemActionNotification).then(function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':actionNotificationDone', true);\n\t\t\t}, function () {\n\t\t\t\tEventService.send('itemInstance:' + event.split(':')[1] + ':actionNotificationDone', false);\n\t\t\t});\n\t\t});\n\n\t\treturn Item;\n\t}\n]);\n"]}