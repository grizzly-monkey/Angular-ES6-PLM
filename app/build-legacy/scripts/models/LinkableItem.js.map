{"version":3,"sources":["../../../scripts/models/LinkableItem.js"],"names":[],"mappings":"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","file":"LinkableItem.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.LinkableItem\n *\n * @description This class wraps a LinkableItem payload into an object\n *\n * ##Dependencies\n * TODO: remove this model, as it has nothing but some functions to get some json properties. Move this stuff to {@link AddExistingLinkableItemController}.\n */\n\n// Define the constructor\nvar LinkableItem = function (json) {\n\tthis.json = json;\n\n\t/**\n\t * @ngdoc property\n\t * @name Models.LinkableItem#selected\n\t * @propertyOf Models.LinkableItem\n\t * @description true, if current item is selected.\n\t *\n\t * @type {Boolean} true, if current item is selected.\n\t *\n\t * TODO: this should be moved away from the modal as its related to presentation.\n\t */\n\tthis.selected = false;\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#removeBaseUrl\n\t * @methodOf Models.LinkableItem\n\t * @description Remove base url from the given link.\n\t *\n\t * @param {String} link The url to be truncated.\n\t * @returns {String} Relative url without base url.\n\t */\n\tthis.removeBaseUrl = function (link) {\n\t\tif ((link.indexOf('api/v2/') !== -1) || (link.indexOf('api/v3/') !== -1)) {\n\t\t\treturn link.substr(7);\n\t\t} else if (link.indexOf('api/rest/v1/') !== -1) {\n\t\t\treturn link.substr(12);\n\t\t}\n\t\treturn link;\n\t};\n\n\t/**\n\t * @ngdoc property\n\t * @name Models.LinkableItem#link\n\t * @propertyOf Models.LinkableItem\n\t * @description The association link of this item.\n\t *\n\t * @type {String} The association link of this item.\n\t */\n\tthis.link = null;\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getObject\n\t * @methodOf Models.LinkableItem\n\t * @description Returns a copy of the object's JSON\n\t *\n\t * @returns {Object} The linked item object\n\t */\n\tthis.getObject = function () {\n\t\treturn angular.copy(this.json);\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getItemLink\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item link\n\t *\n\t * @returns {String} item link\n\t */\n\tthis.getItemLink = function () {\n\t\tthis.link = this.link || this.json.item.link;\n\t\treturn this.link;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getItemId\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item resourceId\n\t *\n\t * @returns {String} ResourceId\n\t */\n\tthis.getItemId = function () {\n\t\tvar ids = this.getItemLink().split(/\\//);\n\t\treturn ids[4] + '@' + ids[6];\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getItemTitle\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item title\n\t *\n\t * @returns {String} item title\n\t */\n\tthis.getItemTitle = function () {\n\t\treturn this.json.item.title;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getItemUrn\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item urn\n\t *\n\t * @returns {String} item urn\n\t */\n\tthis.getItemUrn = function () {\n\t\treturn this.json.item.urn;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getItemVersion\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item version information for revision-controlled\n\t * items\n\t *\n\t * @returns {String} Version tag\n\t */\n\tthis.getItemVersion = function () {\n\t\treturn this.json.item.version || '';\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getWorkspaceTitle\n\t * @methodOf Models.LinkableItem\n\t * @description Returns workspace title\n\t *\n\t * @returns {String} workspace title\n\t */\n\tthis.getWorkspaceTitle = function () {\n\t\treturn this.json.workspace.title;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getLifecycleTitle\n\t * @methodOf Models.LinkableItem\n\t * @description Returns lifecycle title\n\t *\n\t * @returns {String} lifecycle title\n\t */\n\tthis.getLifecycleTitle = function () {\n\t\treturn this.json.lifecycle.title;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#isLifecycle\n\t * @methodOf Models.LinkableItem\n\t * @description Returns true, if item has lifecycle\n\t *\n\t * @returns {Boolean} true, if item has lifecycle\n\t */\n\tthis.isLifecycle = function () {\n\t\treturn !!this.json.lifecycle;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#isLinkedTo\n\t * @methodOf Models.LinkableItem\n\t * @description Return true, if item is already associated with another workspace item.\n\t *\n\t * @returns {boolean} true, if item is already associated with another workspace item.\n\t */\n\tthis.isLinkedTo = function () {\n\t\treturn this.json['linked-to'] && this.json['linked-to'].length > 0;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#itemLinkedTo\n\t * @methodOf Models.LinkableItem\n\t * @description Return the item(s) to which this item is linked\n\t * TODO Since the endpoint doesn't really work properly, this is temporary\n\t *\n\t * @returns {Object} Object with `link` and `title` properties\n\t */\n\tthis.itemLinkedTo = function () {\n\t\treturn this.json['linked-to'][0];\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#itemLinkedToId\n\t * @methodOf Models.LinkableItem\n\t * @description Returns resourceId of the item to which this item is linked\n\t * TODO Since the endpoint doesn't really work properly, this is temporary\n\t *\n\t * @returns {String} ResourceId\n\t */\n\tthis.itemLinkedToId = function () {\n\t\tvar ids = this.itemLinkedTo().link.split(/\\//);\n\t\treturn ids[4] + '@' + ids[6];\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#setSelection\n\t * @methodOf Models.LinkableItem\n\t * @description set selection stage of the item.\n\t *\n\t * TODO: this should be moved away from the modal as its related to presentation.\n\t */\n\tthis.setSelection = function (selected) {\n\t\tthis.selected = selected;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#isSelected\n\t * @methodOf Models.LinkableItem\n\t * @description Returns true, if item is in selected state\n\t *\n\t * @returns {Boolean} true, if item is in selected state\n\t *\n\t * TODO: this should be moved away from the modal as its related to presentation.\n\t */\n\tthis.isSelected = function () {\n\t\treturn !!this.selected;\n\t};\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.LinkableItem#getWorkspaceId\n\t * @methodOf Models.LinkableItem\n\t * @description Returns item's workspace id\n\t *\n\t * @returns {String} Workspace id\n\t */\n\tthis.getWorkspaceId = function () {\n\t\treturn this.getItemUrn().split('.').reverse()[1];\n\t};\n};\n\nangular.module('plm360.models').factory('LinkableItem', [\n\t'RESTWrapperService',\n\t'EventService',\n\tfunction (RESTWrapperService, EventService) {\n\t\tvar models = {};\n\t\tLinkableItem.prototype.RESTWrapperService = RESTWrapperService;\n\t\t// get\n\t\tEventService.listen('linkableItem:*:get', function (event, params) {\n\t\t\tvar model = models[params] || new LinkableItem();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.fetch(params).then(function (obj) {\n\t\t\t\tEventService.send('linkableItem:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\t\treturn LinkableItem;\n\t}\n]);\n"]}