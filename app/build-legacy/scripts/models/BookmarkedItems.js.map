{"version":3,"sources":["../../../scripts/models/BookmarkedItems.js"],"names":[],"mappings":"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","file":"BookmarkedItems.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.BookmarkedItems\n *\n * @description This class wraps a bookmarked items payload into an object\n *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar BookmarkedItems = function (json) {\n\tthis.json = json;\n};\n\nBookmarkedItems.prototype = {\n\t/**\n\t * @ngdoc method\n\t * @name Models.BookmarkedItems#fetch\n\t * @methodOf Models.BookmarkedItems\n\t * @description Make a call to fetch raw data\n\t *\n\t * @param {String} link The URL to use for fetching the data\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t */\n\tfetch: function (link) {\n\t\tvar that = this;\n\t\treturn this.RESTWrapperService.get(link, null, null, {}).then(function (payload) {\n\t\t\tthat.json = payload.bookmarks;\n\n\t\t\tangular.forEach(that.json, function (item) {\n\t\t\t\titem.workspace.id = item.workspace.link.substring(item.workspace.link.lastIndexOf('/') + 1);\n\t\t\t\t// for backwards compatibility, we call \"title\" label, so we copy value\n\t\t\t\titem.workspace.label = item.workspace.title;\n\t\t\t});\n\n\t\t\treturn that;\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.BookmarkedItems#getDisplayableData\n\t * @methodOf Models.BookmarkedItems\n\t * @description Returns formatted data of the bookmarked items to be displayed in a tabular widget\n\t *\n\t * @returns {Object} An object representation of the formatted data\n\t *\n\t */\n\tgetDisplayableData: function () {\n\t\tvar ret = {};\n\t\tvar that = this;\n\n\t\tif ((angular.isDefined(this.json)) && (this.json !== null)) {\n\t\t\tret = angular.copy(this.json);\n\n\t\t\tvar toBeSpliced = [];\n\n\t\t\tangular.forEach(ret, function (value, datalistkey) {\n\n\t\t\t\tif (!value || !value.item) {\n\t\t\t\t\ttoBeSpliced.push(datalistkey);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar wsId = (value.item && value.item.link && value.item.link.split('/')[4]) || null;\n\t\t\t\tvar itemUrn = (value.item && value.item.urn && that.UrnParser.encode(value.item.urn)) || null;\n\t\t\t\tvar wsTitle = value.workspace.label;\n\n\t\t\t\tif (wsId && itemUrn) {\n\n\t\t\t\t\tret[datalistkey].itemdescription = {\n\t\t\t\t\t\tval: value.item.title,\n\t\t\t\t\t\thref: that.$state.href('details', {\n\t\t\t\t\t\t\tworkspaceId: wsId,\n\t\t\t\t\t\t\ttab: 'details',\n\t\t\t\t\t\t\tview: 'full',\n\t\t\t\t\t\t\tmode: 'view',\n\t\t\t\t\t\t\titemId: itemUrn\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t\tret[datalistkey].workspace = {\n\t\t\t\t\t\tval: wsTitle || '',\n\t\t\t\t\t\thref: that.$state.href('workspace-items-list', {workspaceId: wsId})\n\t\t\t\t\t};\n\t\t\t\t\tret[datalistkey].actiontext = {\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\tworkspaceId: wsId,\n\t\t\t\t\t\titemId: itemUrn\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (Array.isArray(ret)) {\n\t\t\t\tvar decrementCounter = 0;\n\t\t\t\tangular.forEach(toBeSpliced, function (value) {\n\t\t\t\t\tret.splice(value - decrementCounter, 1);\n\t\t\t\t\tdecrementCounter++;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\treturn {data: ret};\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.BookmarkedItems#isItemBookmarked\n\t * @methodOf Models.BookmarkedItems\n\t * @description Returns whether an item is bookmarked\n\t *\n\t * @param {Number} itemId The ID of the item to be checked\n\t *\n\t * @returns {Boolean} True if item is bookmarked, false otherwise\n\t */\n\tisItemBookmarked: function (itemId) {\n\t\tvar that = this;\n\t\tvar ret = false;\n\t\tif ((angular.isDefined(this.json)) && (this.json !== null)) {\n\t\t\t_.each(this.json, function (value) {\n\t\t\t\tif (angular.isObject(value) && value.item && value.item !== null) {\n\t\t\t\t\t// Since this item ID format is not used anymore, it should\n\t\t\t\t\t// not be necessary to keep this conditional.\n\t\t\t\t\t// Left it here just for transition sake.\n\t\t\t\t\tif (itemId.indexOf('@') !== -1) {\n\t\t\t\t\t\tvar parsedItemId = itemId.split('@')[1];\n\t\t\t\t\t\tvar thisId = (value.item && value.item.link && value.item.link.split('/')[6]) || null;\n\t\t\t\t\t\tif (parseInt(thisId) === parseInt(parsedItemId)) {\n\t\t\t\t\t\t\tret = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (value.item.urn === that.UrnParser.decode(itemId)) {\n\t\t\t\t\t\t\tret = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn ret;\n\t}\n};\n\nangular.module('plm360.models').factory('BookmarkedItems', [\n\t'RESTWrapperService',\n\t'$state',\n\t'$q',\n\t'UrnParser',\n\t'EventService',\n\t'ModelsManager',\n\tfunction (RESTWrapperService, $state, $q, UrnParser, EventService, ModelsManager) {\n\t\tvar models = {};\n\t\tBookmarkedItems.prototype.RESTWrapperService = RESTWrapperService;\n\t\tBookmarkedItems.prototype.$state = $state;\n\t\tBookmarkedItems.prototype.$q = $q;\n\t\tBookmarkedItems.prototype.UrnParser = UrnParser;\n\t\tBookmarkedItems.prototype.EventService = EventService;\n\t\tBookmarkedItems.prototype.ModelsManager = ModelsManager;\n\t\tEventService.listen('bookmarkedItems:*:get', function (event, params) {\n\t\t\tvar model = models[params] || new BookmarkedItems();\n\t\t\tmodels[params] = model;\n\t\t\tmodel.fetch(params).then(function (obj) {\n\t\t\t\tEventService.send('bookmarkedItems:' + event.split(':')[1] + ':done', obj);\n\t\t\t});\n\t\t});\n\t\treturn BookmarkedItems;\n\t}\n]);\n"]}