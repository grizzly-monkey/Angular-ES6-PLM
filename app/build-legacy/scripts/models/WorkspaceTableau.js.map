{"version":3,"sources":["../../../scripts/models/WorkspaceTableau.js"],"names":[],"mappings":"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","file":"WorkspaceTableau.js","sourcesContent":["'use strict';\n\n/**\n * @ngdoc object\n * @name Models.WorkspaceTableau\n *\n * @description This class wraps a WorkspaceTableau object.\n * You can create a new workspace tableau object\n * Update existing one\n * Fetch for existing ones\n *  *\n * ##Dependencies\n *\n */\n\n// Define the constructor\nvar WorkspaceTableau = function () {\n\tthis.groups = null;\n};\n\n/**\n * @param  {Object} visible [description]\n * @param  {Array} all     [description]\n * @return {Object}         [description]\n */\nvar mergeTableauDefinition = function (visible, all) {\n\tvar groups = {};\n\t// get the urn of each field (so we can search the visible field\n\t// into the all fields array)\n\tvar visibleUrn = _.map(visible.columns, function (value) {\n\t\treturn value.field.urn;\n\t});\n\n\t// adding displayOrder object\n\t_.each(visible.columns,function (columnVisible) {\n\t\t_.each(all,function (columnAll,index) {\n\t\t\tif (columnVisible.field.urn === columnAll.field.urn) {\n\t\t\t\tif (angular.isDefined(columnVisible.displayOrder)) {\n\t\t\t\t\tall[index].displayOrder = columnVisible.displayOrder;\n\t\t\t\t\tif (angular.isDefined(columnVisible.sort)) {\n\t\t\t\t\t\tall[index].sort = columnVisible.sort;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (angular.isDefined(columnVisible.sort)) {\n\t\t\t\t\tall[index].sort = columnVisible.sort;\n\t\t\t\t}\n\t\t\t\tif (angular.isDefined(columnVisible.filter)) {\n\t\t\t\t\tall[index].filter = columnVisible.filter;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t});\n\n\t_.each(all, function (column) {\n\t\t// look if the column is visible or not.\n\t\tcolumn.visible = (_.indexOf(visibleUrn, column.field.urn) !== -1);\n\t\taddToGroup(groups, column);\n\t});\n\n\treturn groups;\n\n};\n\n/**\n * @param {Object} groups  [description]\n * @param {Object} element [description]\n */\nvar addToGroup = function (groups, element) {\n\tvar groupLabel = element.group.label;\n\tif (!groups[groupLabel]) {\n\t\tgroups[groupLabel] = {\n\t\t\tcollapsed: false,\n\t\t\tname: element.group.name,\n\t\t\tfields: []\n\t\t};\n\t}\n\n\tgroups[groupLabel].fields.push(element);\n};\n\nWorkspaceTableau.prototype = {\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#getWorkspaceTableausAllDefinitions\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Given the link of the workspace tableau, it returns all the tableaus configurations for the workspace\n\t *\n\t * @param  {String} link The REST link resource to the workspace tableau endpoint for current workspace\n\t * @return {Object} Promise Object containing array of tableaus\n\t */\n\tgetWorkspaceTableausAllDefinitions: function (link) {\n\t\treturn this.RESTWrapperService.get(link, null, null, {skipCache:true}, {\n\t\t\tACCEPT: this.HTTP_META_VALUES.SIMPLE\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#getWorkspaceTableausAllGroups\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Given the link of the workspace tableau, it returns all the tableaus groups, fields and filters for the current workspace\n\t *\n\t * @param  {String} link The REST link resource to the workspace tableau endpoint for current workspace\n\t * @return {Object} Promise Array of all groups, fields & filters\n\t */\n\tgetWorkspaceTableausAllGroups: function (link) {\n\t\treturn this.RESTWrapperService.get(link, null, null, {skipCache:true}, {\n\t\t\tACCEPT: this.HTTP_META_VALUES.EXTENDED\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#getWorkspaceTableauDefinition\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Given the link of a workspace tableau, it returns it configuration-\n\t *\n\t * @param  {String} wtLink The REST link resource\n\t * @return {Object} Promise Object containing array of columns\n\t */\n\tgetWorkspaceTableauDefinition: function (wtLink) {\n\t\treturn this.RESTWrapperService.get(wtLink, null, null, {skipCache:true}, {\n\t\t\tACCEPT: this.HTTP_META_VALUES.EXTENDED\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#getTableau\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Returns a rich object containing all the tableau configuration\n\t *\n\t * @param  {String} link The REST link resource\n\t * @param  {Number} viewId The tableau ID\n\t * @return {Object} Promise Object containing array of columns\n\t */\n\tgetTableau: function (link, viewId) {\n\t\tvar deferred = this.$q.defer();\n\t\tvar that = this;\n\t\tvar defaultTableau = null;\n\t\tvar allGroups = null;\n\n\t\tdefaultTableau = that.getWorkspaceTableausAllDefinitions(link).then(function (definitions) {\n\t\t\tdefaultTableau = _.filter(definitions.tableaus, function (tableau) {\n\t\t\t\treturn viewId === parseInt(tableau.link.slice(tableau.link.lastIndexOf('/') + 1, tableau.link.length));\n\t\t\t});\n\t\t\tif (defaultTableau.length === 1) {\n\t\t\t\tdefaultTableau = defaultTableau.pop();\n\t\t\t\treturn that.getWorkspaceTableauDefinition(defaultTableau.link.slice(1, defaultTableau.link.length));\n\t\t\t} else {\n\t\t\t\tconsole.info('There is no default tableau');\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\n\t\t// get all groups (groups, fields & filters)\n\t\tallGroups = that.getWorkspaceTableausAllGroups(link);\n\n\t\tthat.$q.all([defaultTableau, allGroups]).then(function (results) {\n\t\t\tdefaultTableau = results.shift();\n\t\t\tif (!defaultTableau) {\n\t\t\t\tdeferred.resolve({});\n\t\t\t} else {\n\t\t\t\tallGroups = results.shift();\n\n\t\t\t\tdeferred.resolve(mergeTableauDefinition(defaultTableau, allGroups));\n\t\t\t}\n\t\t});\n\n\t\treturn deferred.promise;\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#fetchAllWorkspaceTableau\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Returns a rich object containing all the tableau configuration\n\t *\n\t * @param  {String} link The REST link resource\n\t * @return {Object} Promise Object containing array of tableaus\n\t */\n\tfetchAllWorkspaceTableau: function (link) {\n\t\t// get all tableaus of workspace\n\t\treturn this.getWorkspaceTableausAllDefinitions(link).then(function (response) {\n\t\t\treturn response.tableaus;\n\t\t});\n\t},\n\n\t/**\n\t * @ngdoc method\n\t * @name Models.WorkspaceTableau#update\n\t * @methodOf Models.WorkspaceTableau\n\t * @description Update an existing tableau configuration\n\t *\n\t * @param  {String} link The REST link resource\n\t * @param  {Object} tableau The tableau configuration\n\t * @return {Object} Promise Object containing array of tableaus\n\t */\n\tupdate: function (link, tableau) {\n\t\tvar deferred = this.$q.defer();\n\t\tvar that = this;\n\t\tvar payloadBuilder;\n\t\tthat.getWorkspaceTableauDefinition(link).then(function (currentTableau) {\n\t\t\tpayloadBuilder = that.TableauPayloadBuilder(currentTableau, tableau, _);\n\n\t\t\tthat.RESTWrapperService.put(payloadBuilder, link, null, null, {\n\t\t\t\t'Content-Type': that.HTTP_META_VALUES.EXTENDED\n\t\t\t}, {}).then(function (result) {\n\t\t\t\tdeferred.resolve(result);\n\t\t\t}, function (error) {\n\t\t\t\tdeferred.reject(error);\n\t\t\t});\n\t\t}, function (error) {\n\t\t\tdeferred.reject(error);\n\t\t});\n\n\t\treturn deferred.promise;\n\t},\n\n\tcreateDefault: function (link) {\n\t\treturn this.RESTWrapperService.post(null, link, null, null, {\n\t\t\t'Content-Type': this.HTTP_META_VALUES.SIMPLE\n\t\t});\n\t}\n};\n\nangular.module('plm360.models').factory('WorkspaceTableau', [\n\t'RESTWrapperService',\n\t'EventService',\n\t'TableauPayloadBuilder',\n\t'WORKSPACE_TABLEAU_TYPES',\n\t'HTTP_META_VALUES',\n\t'$q',\n\t'_',\n\tfunction (RESTWrapperService, EventService, TableauPayloadBuilder, WORKSPACE_TABLEAU_TYPES, HTTP_META_VALUES, $q, _) {\n\t\tvar models = {};\n\t\tWorkspaceTableau.prototype.RESTWrapperService = RESTWrapperService;\n\t\tWorkspaceTableau.prototype.TableauPayloadBuilder = TableauPayloadBuilder;\n\t\tWorkspaceTableau.prototype.WORKSPACE_TABLEAU_TYPES = WORKSPACE_TABLEAU_TYPES;\n\t\tWorkspaceTableau.prototype.HTTP_META_VALUES = HTTP_META_VALUES;\n\t\tWorkspaceTableau.prototype.$q = $q;\n\t\tWorkspaceTableau.prototype._ = _;\n\t\tEventService.listen('workspaceTableau:*:getTableau', function (event, link, viewId) {\n\t\t\t// var model = models[link] || new WorkspaceTableau();\n\t\t\tvar model = new WorkspaceTableau();\n\t\t\t// models[link] = model;\n\t\t\tmodel.getTableau(link, viewId).then(function (obj) {\n\t\t\t\tvar done = 'workspaceTableau:' + event.split(':')[1] + ':getTableauDone';\n\t\t\t\tEventService.send(done, obj);\n\t\t\t});\n\t\t});\n\n\t\tEventService.listen('workspaceTableau:*:getAllTableau', function (event, link) {\n\t\t\t// var model = models[link] || new WorkspaceTableau();\n\t\t\tvar model = new WorkspaceTableau();\n\t\t\t// models[link] = model;\n\t\t\tmodel.fetchAllWorkspaceTableau(link).then(function (arrayTableaus) {\n\t\t\t\tif (!angular.isDefined(arrayTableaus)) {\n\t\t\t\t\t// no default tableau, let's create one\n\t\t\t\t\tvar workspaceId = link.split('/').splice(3, 1);\n\t\t\t\t\tvar listenerId = EventService.listen('workspaceTableau:*:createDefaultDone', function (event) {\n\t\t\t\t\t\tEventService.unlisten(listenerId);\n\t\t\t\t\t\t// Recursive call\n\t\t\t\t\t\tEventService.send('workspaceTableau:' + workspaceId + ':getAllTableau', [link]);\n\t\t\t\t\t});\n\t\t\t\t\tEventService.send('workspaceTableau:' + workspaceId + ':createDefault', [link]);\n\t\t\t\t} else {\n\t\t\t\t\tvar done = 'workspaceTableau:' + event.split(':')[1] + ':getAllTableauDone';\n\t\t\t\t\tEventService.send(done, {tableaus: arrayTableaus});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tEventService.listen('workspaceTableau:*:updateTableau', function (event, link, tableau) {\n\t\t\t// var model = models[link] || new WorkspaceTableau();\n\t\t\tvar model = new WorkspaceTableau();\n\t\t\t// models[link] = model;\n\t\t\tmodel.update(link, tableau).then(function (result) {\n\t\t\t\tvar done = 'workspaceTableau:' + event.split(':')[1] + ':updateDone';\n\t\t\t\tEventService.send(done, result);\n\t\t\t});\n\t\t});\n\n\t\tEventService.listen('workspaceTableau:*:createDefault', function (event, link) {\n\t\t\tvar model = new WorkspaceTableau();\n\t\t\t\n\t\t\tmodel.createDefault(link).then(function (result) {\n\t\t\t\tvar done = 'workspaceTableau:' + event.split(':')[1] + ':createDefaultDone';\n\t\t\t\tEventService.send(done, result);\n\t\t\t});\n\t\t\t\n\t\t});\n\n\t\treturn WorkspaceTableau;\n\t}\n]).constant('WORKSPACE_TABLEAU_TYPES', {\n\tDEFAULT: 'DEFAULT'\n}).constant('HTTP_META_VALUES', {\n\tSIMPLE: 'application/json',\n\tEXTENDED: 'application/vnd.autodesk.plm.meta+json'\n});"]}