{"version":3,"sources":["../../../components/workspaceItemSourcing/WorkspaceItemSourcingController.js"],"names":[],"mappings":"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","file":"WorkspaceItemSourcingController.js","sourcesContent":["'use strict';\n\nangular.module('plm360.workspaceItemSourcing', [])\n\n/**\n * @ngdoc object\n * @name Controllers.workspaceItemSourcingController\n *\n * @description This controller corresponds to /workspaceItems/{workspaceId}/{itemId}/Sourcing.\n *\n * ##Dependencies\n *\n */\n.controller('WorkspaceItemSourcingController', [\n\t'$scope',\n\t'$window',\n\t'$stateParams',\n\t'$location',\n\t'$filter',\n\t'LocalizationData',\n\t'ModelsManager',\n\t'ChangeLogObj',\n\t'UserObj',\n\t'FlyoutService',\n\t'_',\n\tfunction ($scope, $window, $stateParams, $location, $filter, LocalizationData, ModelsManager, ChangeLogObj, UserObj, FlyoutService, _) {\n\n\t\t/**\n\t\t * @ngdoc property\n\t\t * @name Controllers.workspaceItemSourcingController#firstTimePageLoad\n\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t * @description `private` To avoid convert string in objects when the page is loaded for first time.  {@link Controllers.workspaceItemSourcingController#updateContent}\n\t\t */\n\t\tvar firstTimePageLoad = null;\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.workspaceItemSourcingController#init\n\t\t * @methodOf Controllers.workspaceItemSourcingController\n\t\t * @description Initialization function\n\t\t */\n\t\t$scope.init = function () {\n\n\t\t\tfirstTimePageLoad = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#tableColumns\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Stores table column header\n\t\t\t */\n\t\t\t$scope.tableColumns = [];\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#tableData\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Stores table data of the change log\n\t\t\t */\n\t\t\t$scope.tableData = [];\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#workspaceIcon\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description The class name for the icon of this workspace\n\t\t\t */\n\t\t\t$scope.workspaceIcon = null;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#isItemPinned\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description A boolean var that controls if this item was pinned to the dashboard\n\t\t\t */\n\t\t\t$scope.isItemPinned = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#dateFormat\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Stores the date format\n\t\t\t */\n\t\t\t$scope.dateFormat = null;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#dateAndHourFormat\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Stores the date format, plus hour format\n\t\t\t */\n\t\t\t$scope.dateAndHourFormat = null;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#context\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description The context for attaching handler for infinite scrolling\n\t\t\t */\n\t\t\t$scope.context = angular.element($window);\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#pageNumber\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description The page to fetch data from\n\t\t\t */\n\t\t\t$scope.pageNumber = 1;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#itemQuantity\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Amount of items to fetch\n\t\t\t */\n\t\t\t$scope.itemQuantity = 100;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#endOfList\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description A flag holding whether we've reached the end of all items in the workspace\n\t\t\t */\n\t\t\t$scope.endOfList = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#sortingColumn\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Current column that is being used to sort data by\n\t\t\t */\n\t\t\t$scope.sortingColumn;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.workspaceItemSourcingController#sortingColumn\n\t\t\t * @propertyOf Controllers.workspaceItemSourcingController\n\t\t\t * @description Current order of the sorting\n\t\t\t */\n\t\t\t$scope.sortingOrder;\n\n\t\t\tif (angular.isDefined($stateParams.editItem)) {\n\t\t\t\t$scope.editItem = true;\n\t\t\t} else {\n\t\t\t\t$scope.editItem = false;\n\t\t\t}\n\n\t\t\t// the date/date + hour format of the user\n\t\t\t$scope.dateFormat = UserObj.getDateFormat();\n\t\t\t$scope.dateAndHourFormat = UserObj.getDateFormat() + ' hh:mm a';\n\n\t\t\t// setup table header\n\t\t\t$scope.tableColumns = [\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.supplier,\n\t\t\t\t\tfield: 'supplierInfo',\n\t\t\t\t\tcellRenderer: 'sourcingSupplierRenderer',\n\t\t\t\t\tdisableSort: true,\n\t\t\t\t\twidth: 35\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.quotes,\n\t\t\t\t\tfield: 'supplierQuotes',\n\t\t\t\t\tcellRenderer: 'sourcingQuotesRenderer',\n\t\t\t\t\tdisableSort: true,\n\t\t\t\t\twidth: 65\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// setup inner table header\n\t\t\t$scope.innerTableColumns = [\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.min,\n\t\t\t\t\tfield: 'min',\n\t\t\t\t\twidth: 12\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.max,\n\t\t\t\t\tfield: 'max',\n\t\t\t\t\twidth: 12\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.leadTime,\n\t\t\t\t\tfield: 'leadTime',\n\t\t\t\t\twidth: 26\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.unitCost,\n\t\t\t\t\tfield: 'unitCost',\n\t\t\t\t\twidth: 20\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.comments,\n\t\t\t\t\tfield: 'comments',\n\t\t\t\t\twidth: 20\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdisplayName: LocalizationData.sourcing.useAsDefault,\n\t\t\t\t\tfield: 'useAsDefault',\n\t\t\t\t\tcellRenderer: 'sourcingUseAsDefaultRenderer',\n\t\t\t\t\twidth: 20\n\t\t\t\t}\n\t\t\t];\n\n\t\t\t// initial load, with the data that has been fetched already\n\t\t\t$scope.parseWorkspaceItemSourcingItems(ChangeLogObj.getFullList(), $scope.itemQuantity);\n\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.workspaceItemSourcingController#parseWorkspaceItemSourcingItems\n\t\t * @methodOf Controllers.workspaceItemSourcingController\n\t\t * @description Parse fetch data into table rows\n\t\t *\n\t\t * @param {Object} data change log data as fetched from server.\n\t\t * @param {Number} itemQuantity number of items to be displayed on a single page.\n\t\t */\n\t\t$scope.parseWorkspaceItemSourcingItems = function (data, itemQuantity) {\n\t\t\tif (angular.isDefined(data)) {\n\t\t\t\t$scope.totalItemCount = data.totalRecords || 0;\n\n\t\t\t\tif (_.size(data.elements) < itemQuantity) {\n\t\t\t\t\t$scope.endOfList = true;\n\t\t\t\t}\n\n\t\t\t\t// iterates through each change log item\n\t\t\t\t_.each(data.elements, function (element, index) {\n\n\t\t\t\t\t// assembles the table data\n\t\t\t\t\t$scope.tableData.push({\n\t\t\t\t\t\t// TODO: need to revisit date adjustment\n\t\t\t\t\t\tsupplierInfo: {\n\t\t\t\t\t\t\tsupplier: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.supplier,\n\t\t\t\t\t\t\t\tval: element.userDisplayName\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tstate: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.state,\n\t\t\t\t\t\t\t\tval: element.action\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tsupplierPartNumber: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.supplierPartNumber,\n\t\t\t\t\t\t\t\tval: element.userId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmanufacturer: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.manufacturer,\n\t\t\t\t\t\t\t\tval: element.userDisplayName\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tmanufacturerPartNumber: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.manufacturerPartNumber,\n\t\t\t\t\t\t\t\tval: element.userId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcomment: {\n\t\t\t\t\t\t\t\tkey: LocalizationData.sourcing.comment,\n\t\t\t\t\t\t\t\tval: $filter('UTC')(element.timestamp)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsupplierQuotes: {\n\t\t\t\t\t\t\tcolumns: $scope.innerTableColumns,\n\t\t\t\t\t\t\tdata: [{\n\t\t\t\t\t\t\t\tmin: (index + 1) * Math.random(),\n\t\t\t\t\t\t\t\tmax: (index + 1) * Math.random(),\n\t\t\t\t\t\t\t\tleadTime: (index + 1) * Math.random(),\n\t\t\t\t\t\t\t\tunitCost: (index + 1) * Math.random(),\n\t\t\t\t\t\t\t\tcomments: $filter('UTC')(element.timestamp),\n\t\t\t\t\t\t\t\tuseAsDefault: true\n\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.workspaceItemSourcingController#doScroll\n\t\t * @methodOf Controllers.workspaceItemSourcingController\n\t\t * @description Scroll event handler for infinite scrolling\n\t\t */\n\t\t$scope.doScroll = function () {\n\t\t\tif ($scope.endOfList) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t$scope.pageNumber++;\n\n\t\t\t// TODO: USE PROPER METHOD FOR Sourcing\n\t\t\t// ModelsManager.getChangeLog($scope.workspaceId, $scope.itemId, $scope.sortingOrder, $scope.sortingColumn, $scope.pageNumber, $scope.itemQuantity).then(function (data) {\n\t\t\t// \t$scope.parseWorkspaceItemChangeLogItems(data.getFullList(), $scope.itemQuantity);\n\t\t\t// });\n\t\t};\n\t}\n]);\n"]}