{"version":3,"sources":["../../../components/workspaceItems/WorkspaceItemsController.js"],"names":[],"mappings":"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","file":"WorkspaceItemsController.js","sourcesContent":["'use strict';\n\nangular.module('plm360.workspaceItems', [])\n\n/**\n * @ngdoc object\n * @name Controllers.WorkspaceItemsController\n *\n * @description This controller corresponds to /workspaceItems/{workspaceId}.\n *\n * ##Dependencies\n *\n */\n.controller('WorkspaceItemsController', [\n\t'$scope',\n\t'$rootScope',\n\t'$log',\n\t'$state',\n\t'$stateParams',\n\t'$location',\n\t'$window',\n\t'$q',\n\t'EventService',\n\t'ModelsManager',\n\t'LocalizationService',\n\t'$timeout',\n\t'$mdSidenav',\n\t'$mdComponentRegistry',\n\t'uiGridConstants',\n\t'FieldTypes',\n\t'_',\n\t'PLMPermissions',\n\tfunction ($scope, $rootScope, $log, $state, $stateParams, $location, $window, $q, EventService, ModelsManager, LocalizationService, $timeout, $mdSidenav, $mdComponentRegistry, uiGridConstants, FieldTypes, _, PLMPermissions) {\n\t\t// listeners IDs\n\t\tvar viewsListenerId;\n\t\tvar refreshViewTableau;\n\t\tvar workspaceListenerId;\n\t\tvar currentUserListenerId;\n\t\tvar itemsListenerId;\n\t\tvar workspacePermissionErrorListenerId;\n\t\tvar workspaceTableauUpdateListener;\n\n\t\t/**\n\t\t * @ngdoc property\n\t\t * @name Controllers.WorkspaceItemsController#regExpUrnUnique\n\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t * @description Reg exp used to transform urn into a valid field ID.\n\t\t */\n\t\tvar regExpUrnUnique = /(\\.|\\:)+/g;\n\n\t\t// flag to check whether we have the metadata, and holds metadata\n\t\t$scope.workspaceMetadata = false;\n\n\t\t/**\n\t\t * @ngdoc property\n\t\t * @name Controllers.WorkspaceItemsController#getTableauToDisplay\n\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t * @description A tableau to display at the dropdow of tableaus (this logic is separated so be able to test it)\n\t\t */\n\t\t$scope.getTableauToDisplay = function (allTableaus) {\n\n\t\t\t// loading the default tableau at the action dropdown\n\t\t\tvar tableau = _.find(allTableaus.tableaus, function (tableauObj) {\n\t\t\t\t\treturn tableauObj.type === 'DEFAULT';\n\t\t\t});\n\t\t\t// showing the first tableau if it doesn´t have a DEFUALT one\n\t\t\tif (!angular.isDefined(tableau)) {\n\t\t\t\ttableau = _.sortBy(allTableaus.tableaus,function (tableauObj) {\n\t\t\t\t\treturn tableauObj.title;\n\t\t\t\t}).shift();\n\t\t\t}\n\n\t\t\treturn tableau;\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#ngInit\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description Initialization function\n\t\t */\n\t\t$scope.init = function () {\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#workspaceId\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The workspace Id of the current selected workspace\n\t\t\t */\n\t\t\t$scope.workspaceId = $stateParams.workspaceId;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#workspaceObj\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The workspace object\n\t\t\t */\n\t\t\t$scope.workspaceObj = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#bundle\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description Ties to localization bundle of rootScope\n\t\t\t */\n\t\t\t$scope.bundle = $rootScope.bundle;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewName\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The name of the currently selected view\n\t\t\t */\n\t\t\t$scope.viewName = '';\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewId\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The id of the currently selected view\n\t\t\t */\n\t\t\t$scope.viewId = null;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#defaultViewId\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The id of the default view\n\t\t\t */\n\t\t\t$scope.defaultViewId = null;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#views\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description An object containing the list of all views available in this workspace\n\t\t\t */\n\t\t\t$scope.views = [];\n\n\t\t\t// Listeners to the new tableau (old view objects based on reports)\n\t\t\tviewsListenerId = EventService.listen('workspaceTableau:' + $scope.workspaceId + ':getAllTableauDone', function (event, allTableaus) {\n\t\t\t\tEventService.unlisten(viewsListenerId);\n\n\t\t\t\tallTableaus.tableaus = _.each(allTableaus.tableaus, function (tableau) {\n\t\t\t\t\t// backward compatibility\n\t\t\t\t\ttableau.id = parseInt(tableau.link.slice(tableau.link.lastIndexOf('/') + 1 , tableau.link.length));\n\t\t\t\t});\n\n\t\t\t\tvar tableau = $scope.getTableauToDisplay(allTableaus);\n\n\t\t\t\t$scope.views = allTableaus.tableaus;\n\t\t\t\t$scope.viewId = tableau.id;\n\t\t\t\t$scope.defaultViewId = tableau.id;\n\n\t\t\t\t$scope.viewChange($scope.viewId);\n\t\t\t}, true);\n\t\t\tModelsManager.getAllWorkspaceTableaus($stateParams.workspaceId);\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewData\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The metadata of the current view\n\t\t\t */\n\t\t\t$scope.viewData = {};\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewsFields\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The available fields to be selected\n\t\t\t */\n\t\t\t// $scope.viewsFields = WorkspaceViewsFields.originalElement;\n\t\t\t// _.each($scope.viewsFields, function (value, key) {\n\t\t\t// \t$scope.viewsFields[LocalizationService.translate(key)] = value;\n\t\t\t// \tdelete $scope.viewsFields[key];\n\t\t\t// \t_.each(value, function (field) {\n\t\t\t// \t\t$scope.viewsFieldsFlat.push(field);\n\t\t\t// \t});\n\t\t\t// });\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewDirty\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description A boolean flag set to true or false if the current view has been modified\n\t\t\t */\n\t\t\t// $scope.viewDirty = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#viewsShown\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The flag representing whether the list of views are displayed\n\t\t\t */\n\t\t\t// $scope.viewsShown = false;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#pageNumber\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The page to fetch data from\n\t\t\t */\n\t\t\t$scope.pageNumber = 0;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#itemQuantity\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description Amount of items to fetch\n\t\t\t */\n\t\t\t$scope.itemQuantity = 100;\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#tableData\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description An array holding the parsed data for the table\n\t\t\t */\n\t\t\t$scope.tableData = {\n\t\t\t\tcolumns: [],\n\t\t\t\trows: []\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#workspaceName\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The name of the workspace that these items belong to\n\t\t\t */\n\t\t\t$scope.workspaceName = '';\n\n\t\t\t// If the user doesn't have 'View items' permission for this\n\t\t\t// workspace, go to the dashboard and show the permission error\n\t\t\t// modal\n\t\t\tworkspacePermissionErrorListenerId = EventService.listen('workspaceInstance:' + $scope.workspaceId + ':permissionError', function () {\n\t\t\t\t$state.go('dashboard');\n\t\t\t\tEventService.send('workspaceInstance:' + $scope.workspaceId + ':permissionDenied', $scope.workspaceId);\n\t\t\t});\n\n\t\t\tworkspaceListenerId = EventService.listen('workspaceInstance:' + $scope.workspaceId + ':done', function (event, WorkspaceObj) {\n\t\t\t\t$scope.workspaceName = WorkspaceObj.getDisplayName();\n\t\t\t\t$scope.workspaceObj = WorkspaceObj;\n\t\t\t}, true);\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#dateOptions\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description The options for calendar\n\t\t\t */\n\t\t\t$scope.dateOptions = {\n\t\t\t\t'year-format': 'yyyy',\n\t\t\t\t'starting-day': 1\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#dateFormat\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description Stores the date format\n\t\t\t */\n\t\t\t$scope.dateFormat = 'yyyy';\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#dateAndHourFormat\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description Stores the date format, plus hour format\n\t\t\t */\n\t\t\t$scope.dateAndHourFormat = 'yyyy hh:mm a';\n\n\t\t\t/**\n\t\t\t * @ngdoc property\n\t\t\t * @name Controllers.WorkspaceItemsController#hasAddItemsPermission\n\t\t\t * @propertyOf Controllers.WorkspaceItemsController\n\t\t\t * @description Flag representing the user permissions for adding items in the workspace.\n\t\t\t */\n\t\t\t$scope.hasAddItemsPermission = false;\n\n\t\t\tcurrentUserListenerId = EventService.listen('currentUser:currentUser:done', function (event, UserObj) {\n\t\t\t\t$scope.dateFormat = UserObj.getDateFormat();\n\t\t\t\t$scope.dateAndHourFormat = UserObj.getDateFormat() + ' hh:mm a';\n\n\t\t\t\t// TODO: We should change this approach and use the is-permitted directive, it was not used at this stage, because\n\t\t\t\t// it has some issues when the evaluated value is received after the element was removed.\n\n\t\t\t\t// is-permitted directive problem:\n\n\t\t\t\t// The value required to enable/disable the button is the boolean returned by the UserObj.hasPermission method.\n\t\t\t\t// This value is retrieved after the directive's html was rendered, so the button element is removed anyway even if finally\n\t\t\t\t// the value is truthy; the directive observes ($observe) the workspace id value for changes but not the isPermitted arg,\n\t\t\t\t// we can add this functionality and observe as well this argument but since the element was already removed, we face a new\n\t\t\t\t// controversy: we could change the directive to save the element's parent, and append it again once we know that it is permitted\n\t\t\t\t// or hide the element.\n\t\t\t\t// The problem with the first approach is that we should know the position in which the element used to be, to know whether we should\n\t\t\t\t// appending it, prepending it, or whatever. The other solution would be to change the way we remove the element, and\n\t\t\t\t// not removing it, but hiding it instead. I would vote for this last one.\n\t\t\t\t// Since the directive is already being used, any change to it would require extra care to not break stuff somewhere.\n\n\t\t\t\t$scope.hasAddItemsPermission = UserObj.hasPermission(PLMPermissions.ADD_ITEMS);\n\t\t\t}, true);\n\n\t\t\tworkspaceTableauUpdateListener = EventService.listen('workspaceTableau:' + $scope.workspaceId + ':update', function (evt, currentConfig) {\n\t\t\t\tvar wtLink = ModelsManager.getAppModel().getWorkspaceTableau($scope.workspaceId) + '/' + $scope.viewId;\n\t\t\t\tEventService.send('workspaceTableau:' + $scope.workspaceId + ':updateTableau', wtLink, currentConfig);\n\t\t\t});\n\t\t\t// refreshing the view after update from flyout\n\t\t\trefreshViewTableau = EventService.listen('workspaceTableau:' + $scope.workspaceId + ':updateDone', function (evt) {\n\t\t\t\t$scope.viewChange($scope.viewId);\n\t\t\t});\n\t\t\tModelsManager.getWorkspace($stateParams.workspaceId);\n\t\t\tModelsManager.getCurrentUser();\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#triggerAddItem\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description Navigates to the create item view\n\t\t */\n\t\t$scope.triggerAddItem = function () {\n\t\t\tif ($scope.hasAddItemsPermission) {\n\t\t\t\t$state.go('add-item', {\n\t\t\t\t\tworkspaceId: $scope.workspaceId,\n\t\t\t\t\titemId: null\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#viewChange\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description Handles view change to reset the data\n\t\t *\n\t\t * @param {integer} viewLink The Id of the view to be loaded\n\t\t */\n\t\t$scope.viewChange = function (viewId) {\n\t\t\tif (!$scope.workspaceObj) {\n\t\t\t\t$timeout(function () {\n\t\t\t\t\t$scope.viewChange(viewId);\n\t\t\t\t}, 0);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$scope.workspaceObj.getSectionsMeta()\n\t\t\t\t.then(function () {\n\t\t\t\t\t$scope.workspaceMetadata = $scope.workspaceObj.getSectionsMetadata();\n\t\t\t\t\t$scope.tableData.columns = [];\n\t\t\t\t\t$scope.viewId = viewId;\n\t\t\t\t\t$scope.selectedFilterColumns = $scope.viewData.displayFieldsList;\n\n\t\t\t\t\t$scope.viewName = _.find($scope.views, function (view) {\n\t\t\t\t\t\treturn view.id === $scope.viewId;\n\t\t\t\t\t}).title;\n\n\t\t\t\t\t$scope.getWorkspaceItemsData();\n\t\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#isViewSelected\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description Checks whether a view is selected, (technically this is not a method of the controller but of\n\t\t * the $scope), left it this way beacuse of ngdoc failure\n\t\t */\n\t\t$scope.isViewSelected = function (viewId) {\n\t\t\tif (angular.isDefined($scope.viewId)) {\n\t\t\t\treturn (viewId === $scope.viewId) ? 'selected' : '';\n\t\t\t}\n\t\t};\n\n\t\t$scope.currentOrder;\n\t\t$scope.currentColumnId;\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#getWorkspaceItemsData\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description THIS IS A TEMPORARY METHOD UNTIL THIS CONTROLLER\n\t\t * GETS TRANSLATED MOVED TO ES6.\n\t\t *\n\t\t * TODO There's a lot more cleanup that needs to be done in this messy controller :(\n\t\t */\n\t\t$scope.getWorkspaceItemsData = function (order, columnId) {\n\t\t\tvar deferred = $q.defer();\n\n\t\t\tcolumnId = angular.isDefined(columnId) ? columnId.split('-').pop() : undefined;\n\n\t\t\tif ((order !== $scope.currentOrder) || (columnId !== $scope.currentColumnId)) {\n\t\t\t\t// Assigns the new vars locally\n\t\t\t\t$scope.currentOrder = order;\n\t\t\t\t$scope.currentColumnId = columnId;\n\n\t\t\t\t$scope.pageNumber = 1;\n\n\t\t\t\t// Resets the data\n\t\t\t\t$scope.tableData.rows = [];\n\n\t\t\t} else {\n\t\t\t\t++$scope.pageNumber;\n\t\t\t}\n\n\t\t\tvar itemsListenerId = EventService.listen('items:' + $scope.workspaceId + ':done', function (event, obj) {\n\t\t\t\tEventService.unlisten(itemsListenerId);\n\t\t\t\t// Pull from service which configuration need to show\n\t\t\t\tvar workspaceTableau = EventService.listen('workspaceTableau:' + $scope.workspaceId + '@' + $scope.viewId + ':getTableauDone', function (event, tableauConfig) {\n\t\t\t\t\tEventService.unlisten(workspaceTableau);\n\t\t\t\t\t// This is a bit ugly, but will get better once this is moved to an ES6 promise\n\t\t\t\t\tif ($scope.parseWorkspaceItems(obj.getFullList(), $scope.itemQuantity, tableauConfig)) {\n\t\t\t\t\t\tdeferred.resolve();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeferred.reject();\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t\tModelsManager.getWorkspaceTableau($scope.workspaceId, $scope.viewId, false);\n\t\t\t});\n\t\t\tModelsManager.getItems($scope.workspaceId, $scope.viewId, order, columnId, $scope.pageNumber, $scope.itemQuantity);\n\n\t\t\treturn deferred.promise;\n\t\t};\n\n\t\t/**\n\t\t * @ngdoc method\n\t\t * @name Controllers.WorkspaceItemsController#parseWorkspaceItems\n\t\t * @methodOf Controllers.WorkspaceItemsController\n\t\t * @description Parses the list of items fetched from the endpoint, constrained to the view, for proper displaying in the view\n\t\t *\n\t\t * @param {Object} \tdata \t\t\tThe list of items\n\t\t * @param {Integer}\titemQuantity \tThe amount of items to be retrieved from each batch\n\t\t * @param {Object} \ttableau \t\tThe data from the backend\n\t\t */\n\t\t$scope.parseWorkspaceItems = function (data, itemQuantity, tableau) {\n\t\t\tif (angular.isDefined(data)) {\n\n\t\t\t\t$scope.totalItemCount = data.total || 0;\n\n\t\t\t\tvar columns = _.chain(tableau)\n\t\t\t\t.map(function (group) {\n\t\t\t\t\treturn _.chain(group.fields)\n\t\t\t\t\t.filter(function (field) {\n\t\t\t\t\t\t// fields with no display order are filters\n\t\t\t\t\t\treturn (field.visible) && angular.isDefined(field.displayOrder);\n\t\t\t\t\t}).map(function (field) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tindex: field.displayOrder,\n\t\t\t\t\t\t\tid: field.field.urn.replace(regExpUrnUnique, '-'),\n\t\t\t\t\t\t\turn: field.field.urn,\n\t\t\t\t\t\t\tdisplayName: field.field.title,\n\t\t\t\t\t\t\tsort: (field.sort) ? field.sort : undefined\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t\t.value();\n\t\t\t\t})\n\t\t\t\t.flatten()\n\t\t\t\t.sortBy('index')\n\t\t\t\t.value();\n\n\t\t\t\t_.each(columns, function (column, columnIndex) {\n\t\t\t\t\t// If the column header is already defined, don't push it again\n\t\t\t\t\tvar gridCol = _.find($scope.tableData.columns, function (existingCol) {\n\t\t\t\t\t\treturn existingCol.field === column.id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (gridCol === undefined) {\n\t\t\t\t\t\tvar uiGridCol = {\n\t\t\t\t\t\t\tdisplayName: column.displayName,\n\t\t\t\t\t\t\tsuppressRemoveSort: true,\n\t\t\t\t\t\t\tfield: column.id,\n\t\t\t\t\t\t\turn: column.urn,\n\t\t\t\t\t\t\tcellTemplate: (columnIndex === 0) ? 'itemsLinkRenderer' : 'itemsOtherRenderer'\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (angular.isDefined(column.sort)) {\n\t\t\t\t\t\t\tuiGridCol.sort = {\n\t\t\t\t\t\t\t\tdirection: column.sort.direction.toLowerCase() === 'asc' ? 'asc' :'desc',\n\t\t\t\t\t\t\t\tpriority: 1 + (column.sort.order ? column.sort.order : 0)\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t// This is a previous comment:\n\t\t\t\t\t\t\t// --> Temporary, just to set the first column as the current one being sorted by (which is the default from the backend)\n\t\t\t\t\t\t\t$scope.currentOrder = uiGridCol.sort.direction;\n\t\t\t\t\t\t\t$scope.currentColumnId = column.id;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$scope.tableData.columns.push(uiGridCol);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Asighed the tableau to the scope of the controller for being able to access it inside the uigrid component\n\t\t\t\t$scope.tableau = tableau;\n\t\t\t\t$scope.tableauCallback = 'workspaceTableau:' + $scope.workspaceId + ':update';\n\n\t\t\t\t// Open tableau configuration widget\n\t\t\t\tvar uiGridColEmpty = {\n\t\t\t\t\t\t\tdisplayName: '',\n\t\t\t\t\t\t\tname: 'columnButtton',\n\t\t\t\t\t\t\tfield: '',\n\t\t\t\t\t\t\tvisible: true,\n\t\t\t\t\t\t\tenableSorting: false,\n\t\t\t\t\t\t\tenableFiltering: false,\n\t\t\t\t\t\t\tenableHiding: false,\n\t\t\t\t\t\t\tenableColumnResizing: false,\n\t\t\t\t\t\t\twidth: 40,\n\t\t\t\t\t\t\theaderCellTemplate: '<workspace-tableau-flyout columns=\"grid.appScope.tableau\" callback=\"grid.appScope.tableauCallback\" />'\n\t\t\t\t};\n\t\t\t\t$scope.tableData.columns.push(uiGridColEmpty);\n\n\t\t\t\t// temporarily holding parsed rows\n\t\t\t\tvar parsedRows = [];\n\t\t\t\tif ($scope.pageNumber > 1) {\n\t\t\t\t\tparsedRows = $scope.tableData.rows;\n\t\t\t\t}\n\n\t\t\t\tvar processField = function (fieldId, field, fieldDef, item) {\n\t\t\t\t\tvar fieldValue = (field.value === '') ? '' : field.value;\n\t\t\t\t\tvar fieldType = FieldTypes.NOOB;\n\t\t\t\t\tvar itemId = item && item.item && item.item.link && item.item.link.substring(item.item.link.lastIndexOf('/') + 1);\n\t\t\t\t\tfieldType = fieldDef.fieldMetadata.type.link;\n\t\t\t\t\tfieldType = parseInt(fieldType.substring(fieldType.lastIndexOf('/') + 1));\n\t\t\t\t\t// well let's format the json so that our fieldView directive knows what to do\n\t\t\t\t\t// TODO: let's have the endpoint return properly\n\t\t\t\t\tif (fieldType === FieldTypes.MULTISELECT || fieldType === FieldTypes.MULTISELECT_LINKED) { // multiselect currently is using formatted html with <BR>\n\t\t\t\t\t\tvar values = fieldValue.split('<BR/>');\n\t\t\t\t\t\t_.each(values, function (val, ind) {\n\t\t\t\t\t\t\tvalues[ind] = {\n\t\t\t\t\t\t\t\ttitle: val\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfieldValue = values;\n\t\t\t\t\t} else if (fieldType === FieldTypes.IMAGE) { // images only has the id number in this payload, let's construct something\n\t\t\t\t\t\tif (fieldValue !== '') {\n\t\t\t\t\t\t\titem.fields.forEach(function (val, index) {\n\t\t\t\t\t\t\t\tif (val.value === fieldValue) {\n\t\t\t\t\t\t\t\t\t$scope.tableData.columns[index].cellTemplate = 'itemsThumbnailRenderer';\n\n\t\t\t\t\t\t\t\t\tif (index === 0) {\n\t\t\t\t\t\t\t\t\t\t$scope.tableData.columns[0].cellTemplate = 'itemsLinkedThumbnailRenderer';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfieldValue = {\n\t\t\t\t\t\t\t\tlink: '/api/v2/workspaces/' + $scope.workspaceId + '/items/' + itemId + '/field-values/' + field.id + '/image/' + fieldValue\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tfieldValue.listMode = 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldType = FieldTypes.NOOB;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (fieldType === FieldTypes.FLASH) { // flashes only has the id number in this payload, let's construct something\n\t\t\t\t\t\tif (fieldValue !== '') {\n\n\t\t\t\t\t\t\tfieldValue = {\n\t\t\t\t\t\t\t\tlink: '/api/v2/workspaces/' + $scope.workspaceId + '/items/' + itemId + '/field-values/' + field.id + '/image/' + fieldValue + '?attachment=1'\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfieldType = FieldTypes.NOOB;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn [fieldType, fieldValue];\n\t\t\t\t};\n\n\t\t\t\t// builds the data\n\t\t\t\t_.each(data.items, function (item, itemIndex) { // loops through each object available in the list\n\t\t\t\t\tvar parsedItem = {};\n\t\t\t\t\tvar parsedUiGridRow = {};\n\n\t\t\t\t\t_.each(item.fields, function (field, fieldIndex) { // loops through each object's list of fields\n\t\t\t\t\t\tvar fieldValue = (field.value === '') ? '' : field.value;\n\n\t\t\t\t\t\tvar fieldType = FieldTypes.SINGLE_LINE_TEXT; // default to single line text for system fields\n\n\t\t\t\t\t\t_.each($scope.workspaceMetadata, function (section) {\n\t\t\t\t\t\t\t_.each(section.definition.fields, function (fieldDef) {\n\t\t\t\t\t\t\t\tvar ret = [fieldType, fieldValue];\n\t\t\t\t\t\t\t\tif (fieldDef.type === 'FIELD') {\n\t\t\t\t\t\t\t\t\tif (fieldDef.urn === field.urn) {\n\t\t\t\t\t\t\t\t\t\tret = processField(field.urn, field, fieldDef, item);\n\t\t\t\t\t\t\t\t\t\tfieldType = ret[0];\n\t\t\t\t\t\t\t\t\t\tfieldValue = ret[1];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t_.each(fieldDef.definition.fields, function (row) {\n\t\t\t\t\t\t\t\t\t\t_.each(row, function (col) {\n\t\t\t\t\t\t\t\t\t\t\tif (col !== null) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (col.urn === field.urn) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tret = processField(col.urn, field, col, item);\n\t\t\t\t\t\t\t\t\t\t\t\t\tfieldType = ret[0];\n\t\t\t\t\t\t\t\t\t\t\t\t\tfieldValue = ret[1];\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar fieldKeyId = field.urn.replace(regExpUrnUnique, '-');\n\t\t\t\t\t\tif (fieldIndex === 0) {\n\t\t\t\t\t\t\tparsedItem[fieldKeyId] = {\n\t\t\t\t\t\t\t\tvalue: fieldValue,\n\t\t\t\t\t\t\t\tmetadata: {\n\t\t\t\t\t\t\t\t\tdataTypeId: (fieldType === FieldTypes.IMAGE) ? FieldTypes.IMG_THUMB : fieldType\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thref: $state.href('details', {\n\t\t\t\t\t\t\t\t\ttab: 'details',\n\t\t\t\t\t\t\t\t\tview: 'split',\n\t\t\t\t\t\t\t\t\tmode: 'view',\n\t\t\t\t\t\t\t\t\titemId: item.urn\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\turn: item.urn\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tparsedItem[fieldKeyId] = {\n\t\t\t\t\t\t\t\tvalue: fieldValue,\n\t\t\t\t\t\t\t\tmetadata: {\n\t\t\t\t\t\t\t\t\tdataTypeId: fieldType\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tparsedUiGridRow[fieldKeyId] = parsedItem[fieldKeyId];\n\t\t\t\t\t});\n\n\t\t\t\t\tparsedRows.push(parsedUiGridRow);\n\t\t\t\t});\n\t\t\t\t$scope.tableData.rows = parsedRows;\n\n\t\t\t}\n\n\t\t\t// Just temporary, until this method gets nuked\n\t\t\tif (_.size(data.items) < itemQuantity) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t};\n\n\t\t$scope.$on('$destroy', function () {\n\t\t\tEventService.unlisten(viewsListenerId);\n\t\t\tEventService.unlisten(workspaceListenerId);\n\t\t\tEventService.unlisten(currentUserListenerId);\n\t\t\tEventService.unlisten(workspacePermissionErrorListenerId);\n\t\t\tEventService.unlisten(workspaceTableauUpdateListener);\n\t\t\tEventService.unlisten(refreshViewTableau);\n\t\t});\n\t}\n]);"]}