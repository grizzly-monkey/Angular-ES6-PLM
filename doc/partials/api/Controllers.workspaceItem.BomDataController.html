<h1><code ng:non-bindable="">BomDataController</code>
<div><span class="hint">service in module <code ng:non-bindable="">Controllers.workspaceItem</code>
</span>
</div>
</h1>
<div><h2 id="description">Description</h2>
<div class="description"><div class="controllers-workspaceitem-bomdatacontroller-page"><p>Controller for Bom data</p>
</div></div>
<div class="member method"><h2 id="methods">Methods</h2>
<ul class="methods"><li><h3 id="methods_addpathtotable">addPathToTable(the)</h3>
<div class="addpathtotable"><div class="controllers-workspaceitem-bomdatacontroller-addpathtotable-page"><p>if a row corresponding to &#39;path&#39; does not exist in the table,
Turns a BomPath into a row and adds it to the table</p>
</div><h5 id="methods_addpathtotable_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>the</td><td><a href="" class="label type-hint type-hint-bompath">BomPath</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-addpathtotable-page"><p>requested Path</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_constructor">constructor()</h3>
<div class="constructor"><div class="controllers-workspaceitem-bomdatacontroller-constructor-page"><p>Constructs the BomDataController instance</p>
</div></div>
</li>
<li><h3 id="methods_filltablefrompath">fillTableFromPath(path)</h3>
<div class="filltablefrompath"><div class="controllers-workspaceitem-bomdatacontroller-filltablefrompath-page"><p>For a given path, adds it and its children to the table</p>
</div><h5 id="methods_filltablefrompath_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>path</td><td><a href="" class="label type-hint type-hint-bompath">BomPath</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-filltablefrompath-page"><p>Path to the current row</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_getconfigurationstatemachine">getConfigurationStateMachine()</h3>
<div class="getconfigurationstatemachine"><div class="controllers-workspaceitem-bomdatacontroller-getconfigurationstatemachine-page"><p>Returns the current configuration state machine</p>
</div><h5 id="methods_getconfigurationstatemachine_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-bomconfigurationstatemachine">BomConfigurationStateMachine</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getconfigurationstatemachine-page"><p>the configuration state machine</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getcurrentviewdef">getCurrentViewDef()</h3>
<div class="getcurrentviewdef"><div class="controllers-workspaceitem-bomdatacontroller-getcurrentviewdef-page"><p>Returns the currently selected view definitions</p>
</div><h5 id="methods_getcurrentviewdef_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-viewdefinition">viewDefinition</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getcurrentviewdef-page"><p>the currently selected view definition</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getgraph">getGraph()</h3>
<div class="getgraph"><div class="controllers-workspaceitem-bomdatacontroller-getgraph-page"><p>Returns the current bom graph</p>
</div><h5 id="methods_getgraph_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-bomgraph">BomGraph</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getgraph-page"><p>the graph</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getinitdepth">getInitDepth()</h3>
<div class="getinitdepth"><div class="controllers-workspaceitem-bomdatacontroller-getinitdepth-page"><p>getter for the initial loading depth of Bom.</p>
</div><h5 id="methods_getinitdepth_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-number">Number</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getinitdepth-page"><p>the initial bom depth.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getitemobj">getItemObj()</h3>
<div class="getitemobj"><div class="controllers-workspaceitem-bomdatacontroller-getitemobj-page"><p>Returns the Item object associated with the current topline</p>
</div><h5 id="methods_getitemobj_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-item">Item</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getitemobj-page"><p>the current item object</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_gettable">getTable()</h3>
<div class="gettable"><div class="controllers-workspaceitem-bomdatacontroller-gettable-page"><p>Returns the current bom table</p>
</div><h5 id="methods_gettable_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-bomtable">BomTable</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-gettable-page"><p>the table</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_getviewdefs">getViewDefs()</h3>
<div class="getviewdefs"><div class="controllers-workspaceitem-bomdatacontroller-getviewdefs-page"><p>Returns all the view definitions</p>
</div><h5 id="methods_getviewdefs_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-viewdefinitions">viewDefinitions</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-getviewdefs-page"><p>the view definitions instance</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_init">init()</h3>
<div class="init"><div class="controllers-workspaceitem-bomdatacontroller-init-page"><p>Does the initial load of the Bom
Steps:
    1. Load the item associated with the Bom
    2. Load the view definitions associated with the Bom
    3. Load the Bom corresponding to the item
        if there is a viewDefId stored in the user&#39;s local storage, use that as the view
        Otherwise, use the default view</p>
</div></div>
</li>
<li><h3 id="methods_initbom">initBom()</h3>
<div class="initbom"><div class="controllers-workspaceitem-bomdatacontroller-initbom-page"><p>Completely rebuilds the bom according to the current state of the configuration machine</p>
</div></div>
</li>
<li><h3 id="methods_loadbomitems">loadBomItems(bomNested, parentItemId, bomItems)</h3>
<div class="loadbomitems"><div class="controllers-workspaceitem-bomdatacontroller-loadbomitems-page"><p>Loads a list of bom items</p>
<p>Graph Example
(Parent Node)    &lt;- Input Node (OutEdges are added to node)
|
|                &lt;- Edge (Edge Created, All properties populated)
|
V
(Child Node)        &lt;- Node (Node Created, All properties except OutEdges populated)</p>
<p>The details that come back for each item is a union of the Edge and Node properties.
These are used to create the edge and node which are added to the graph and we update the parent&#39;s outedges</p>
</div><h5 id="methods_loadbomitems_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>bomNested</td><td><a href="" class="label type-hint type-hint-bomnested">BomNested</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomitems-page"><p>the BomNested where the link to each item is found</p>
</div></td></tr><tr><td>parentItemId</td><td><a href="" class="label type-hint type-hint-string">String</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomitems-page"><p>the item id (currently in wsId@dmsId) format of the parent item</p>
</div></td></tr><tr><td>bomItems</td><td><a href="" class="label type-hint type-hint-array">Array</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomitems-page"><p>an array of objects with id properties, where id is the dms id of the item</p>
</div></td></tr></tbody></table><h5 id="methods_loadbomitems_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomitems-page"><p>A promise that will be resolved when all the items have loaded</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_loadbomroot">loadBomRoot(urn, bomConfiguration)</h3>
<div class="loadbomroot"><div class="controllers-workspaceitem-bomdatacontroller-loadbomroot-page"><p>Loads the root node and adds it to the graph,
handling any changes to the configuration that may have occured</p>
</div><h5 id="methods_loadbomroot_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>urn</td><td><a href="" class="label type-hint type-hint-string">String</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomroot-page"><p>that we need to use to call to get the root node
It doesn&#39;t matter what this is, so long as it is part of the lineage
    of the item we want</p>
</div></td></tr><tr><td>bomConfiguration</td><td><a href="" class="label type-hint type-hint-object">Object</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomroot-page"><p>The configuration to use to load the root</p>
</div></td></tr></tbody></table><h5 id="methods_loadbomroot_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbomroot-page"><p>A promise that resolves when the root node has been placed in the graph
With the BomRoot object</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_loadbulkbomandfilltable">loadBulkBomAndFillTable(`row`, `depth`)</h3>
<div class="loadbulkbomandfilltable"><div class="controllers-workspaceitem-bomdatacontroller-loadbulkbomandfilltable-page"><p>Loads the subassebmly of the node represented by the <code>row</code> upto
the <code>depth</code>, and then fills the table starting at the path to that leads to
to node of the <code>row</code> and updates the previously built rows in order to make
sure that they states are correct after the fetching of subassebmly.</p>
</div><h5 id="methods_loadbulkbomandfilltable_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>`row`</td><td><a href="" class="label type-hint type-hint-bomtablerow">BomTableRow</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbulkbomandfilltable-page"><p>the BomTableRow whose node&#39;s subassebmly is to
be populated.</p>
</div></td></tr><tr><td>`depth`</td><td><a href="" class="label type-hint type-hint-number">Number</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbulkbomandfilltable-page"><p>upto what depth should the sub assembly be fetched.</p>
</div></td></tr></tbody></table><h5 id="methods_loadbulkbomandfilltable_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loadbulkbomandfilltable-page"><p>a promise that eventually resolves after the subassebmly
upto the provided <code>depth</code> has been populated for the node.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_loaditemrevisions">loadItemRevisions(row, excludedStatuses)</h3>
<div class="loaditemrevisions"><div class="controllers-workspaceitem-bomdatacontroller-loaditemrevisions-page"><p>Load the revisions for a row,
if that row does not already have revisions loaded</p>
</div><h5 id="methods_loaditemrevisions_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>row</td><td><a href="" class="label type-hint type-hint-bomtablerow">BomTableRow</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loaditemrevisions-page"><p>the row to load revisions for</p>
</div></td></tr><tr><td>excludedStatuses</td><td><a href="" class="label type-hint type-hint-array">Array</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-loaditemrevisions-page"><p>Array of strings indicating revisions that should be excluded</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_populatechildrenandoutputtotable">populateChildrenAndOutputToTable(row)</h3>
<div class="populatechildrenandoutputtotable"><div class="controllers-workspaceitem-bomdatacontroller-populatechildrenandoutputtotable-page"><p>For a given node builds up the children (outgoing edges and nodes) and updates the table to display</p>
<p>Works by fetching the children of the input row.
We begin by outputing any children who are already in the graph to the table
Then, for any children who are not loaded, we load their details in chunks
and output them to the graph
    We have to load in chunks because the browser will only process ~5 requests at a time
        and we have a limit of 15 seconds before a request times out
        If we sent all the requests at once, some of them would timeout</p>
</div><h5 id="methods_populatechildrenandoutputtotable_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>row</td><td><a href="" class="label type-hint type-hint-bomtablerow">BomTableRow</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-populatechildrenandoutputtotable-page"><p>The row whose children should be loaded</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_populateinitialbom">populateInitialBom(`itemUrn`, `bulkEndpointLink`, `queryParams`)</h3>
<div class="populateinitialbom"><div class="controllers-workspaceitem-bomdatacontroller-populateinitialbom-page"><p>Loads BOM data upto the specfied initial depth, updates the
configuration state machine using the information from the fetched payload,
and populates <code>this.bomGraph</code> and <code>this.bomTable</code> from the data.</p>
</div><h5 id="methods_populateinitialbom_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>`itemUrn`</td><td><a href="" class="label type-hint type-hint-string">String</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-populateinitialbom-page"><p>The urn of the item for which the Bom is
being populated.</p>
</div></td></tr><tr><td>`bulkEndpointLink`</td><td><a href="" class="label type-hint type-hint-string">String</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-populateinitialbom-page"><p>the link to which to make the request.</p>
</div></td></tr><tr><td>`queryParams`</td><td><a href="" class="label type-hint type-hint-object">Object</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-populateinitialbom-page"><p>the parameters to be sent to the endpiont.</p>
</div></td></tr></tbody></table><h5 id="methods_populateinitialbom_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-promise">Promise</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-populateinitialbom-page"><p>a promise that eventually resolves to the urn of the root
item.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_processlistinchunks">processListInChunks(chunkSize, list, callback, messageBuilder, chunkIndex)</h3>
<div class="processlistinchunks"><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>Recursive function that processes a list in chunks of chunkSize
blocking the loading of each chunk until the previous chunk has been processed
We take the list in the range [chunkIndex, chunkIndex + chunkSize) and apply the callback.
    When we hear that processing the chunk has completed
        (via listening for the message created by messageBuilder using the chunk index)
        if we are still within the bounds of the list, we recursively call for the next chunk</p>
</div><h5 id="methods_processlistinchunks_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>chunkSize</td><td><a href="" class="label type-hint type-hint-number">Number</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>The size of chunk that the list should be split into</p>
</div></td></tr><tr><td>list</td><td><a href="" class="label type-hint type-hint-array">Array</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>The list of itmes to process</p>
</div></td></tr><tr><td>callback</td><td><a href="" class="label type-hint type-hint-function">Function</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>A function that takes two parameters:
chunk: the items in the current chunk
onReturnMessage: the message that should be sent when the chunk is finished processing</p>
</div></td></tr><tr><td>messageBuilder</td><td><a href="" class="label type-hint type-hint-function">Function</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>A function that takes one parameter:
chunkIndex
and returns a message that distinguishes the chunk at the index</p>
</div></td></tr><tr><td>chunkIndex</td><td><a href="" class="label type-hint type-hint-number">Number</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-processlistinchunks-page"><p>The index tracking where the chunk should start</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_shouldusebulkloader">shouldUseBulkLoader()</h3>
<div class="shouldusebulkloader"><div class="controllers-workspaceitem-bomdatacontroller-shouldusebulkloader-page"><p>Tells us whether or not to use Bulk loading for bom.</p>
</div><h5 id="methods_shouldusebulkloader_returns">Returns</h5><table class="variables-matrix"><tr><td><a href="" class="label type-hint type-hint-boolean">Boolean</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-shouldusebulkloader-page"><p>true if bulk loading is on for bom, and false otherwise.</p>
</div></td></tr></table></div>
</li>
<li><h3 id="methods_updateconfiguration">updateConfiguration(bomRoot)</h3>
<div class="updateconfiguration"><div class="controllers-workspaceitem-bomdatacontroller-updateconfiguration-page"><p>Updates the configuration using the provided bomRoot
Does not update isWorkingRevision, since that requires the Item object</p>
</div><h5 id="methods_updateconfiguration_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>bomRoot</td><td><a href="" class="label type-hint type-hint-bomroot">BomRoot</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-updateconfiguration-page"><p>the root item to use for the configuration</p>
</div></td></tr></tbody></table></div>
</li>
<li><h3 id="methods_updatetarget">updateTarget(itemId)</h3>
<div class="updatetarget"><div class="controllers-workspaceitem-bomdatacontroller-updatetarget-page"><p>Updates the current item to reflect the new top-line of the Bom
and Sets the configuration&#39;s working revsion flag</p>
</div><h5 id="methods_updatetarget_parameters">Parameters</h5><table class="variables-matrix table table-bordered table-striped"><thead><tr><th>Param</th><th>Type</th><th>Details</th></tr></thead><tbody><tr><td>itemId</td><td><a href="" class="label type-hint type-hint-string">String</a></td><td><div class="controllers-workspaceitem-bomdatacontroller-updatetarget-page"><p>that we want to update to</p>
</div></td></tr></tbody></table></div>
</li>
</ul>
</div>
<div class="member property"><h2 id="properties">Properties</h2>
<ul class="properties"><li><h3 id="properties_bomgraph">bomGraph</h3>
<div class="bomgraph"><div class="controllers-workspaceitem-bomdatacontroller-bomgraph-page"><p>Simply the Bom Graph
This is the central location for storage and is traversed to output the Bom Table</p>
</div></div>
</li>
<li><h3 id="properties_bomtable">bomTable</h3>
<div class="bomtable"><div class="controllers-workspaceitem-bomdatacontroller-bomtable-page"><p>Object holding the table columns and rows</p>
</div></div>
</li>
<li><h3 id="properties_configurationstatemachine">configurationStateMachine</h3>
<div class="configurationstatemachine"><div class="controllers-workspaceitem-bomdatacontroller-configurationstatemachine-page"><p>The state machine to track the current configuration of the Bom</p>
</div></div>
</li>
<li><h3 id="properties_currentviewdef">currentViewDef</h3>
<div class="currentviewdef"><div class="controllers-workspaceitem-bomdatacontroller-currentviewdef-page"><p>The currently selected view definition</p>
</div></div>
</li>
<li><h3 id="properties_intialloaddepth">intialLoadDepth</h3>
<div class="intialloaddepth"><div class="controllers-workspaceitem-bomdatacontroller-intialloaddepth-page"><p>The initial depth to use when using the Bom Bulk Api.</p>
</div></div>
</li>
<li><h3 id="properties_itemobj">itemObj</h3>
<div class="itemobj"><div class="controllers-workspaceitem-bomdatacontroller-itemobj-page"><p>The item object for the current topline of the bom</p>
</div></div>
</li>
<li><h3 id="properties_itemurn">itemUrn</h3>
<div class="itemurn"><div class="controllers-workspaceitem-bomdatacontroller-itemurn-page"><p>The urn to use to initialize the bom</p>
</div></div>
</li>
<li><h3 id="properties_usebulkloader">useBulkLoader</h3>
<div class="usebulkloader"><div class="controllers-workspaceitem-bomdatacontroller-usebulkloader-page"><p>Toggle for Bulk loading of the Bom.</p>
</div></div>
</li>
<li><h3 id="properties_viewdefs">viewDefs</h3>
<div class="viewdefs"><div class="controllers-workspaceitem-bomdatacontroller-viewdefs-page"><p>The view definitions that will be loaded</p>
</div></div>
</li>
</ul>
</div>
</div>
